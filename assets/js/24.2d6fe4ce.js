(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{376:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_0-学习目标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_0-学习目标"}},[t._v("#")]),t._v(" 0.学习目标")]),t._v(" "),s("ul",[s("li",[t._v("使用资料搭建后台系统")]),t._v(" "),s("li",[t._v("会使用nginx进行反向代理")]),t._v(" "),s("li",[t._v("实现商品分类查询功能")]),t._v(" "),s("li",[t._v("掌握cors解决跨域")]),t._v(" "),s("li",[t._v("实现品牌查询功能")])]),t._v(" "),s("h1",{attrs:{id:"_1-搭建后台管理前端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-搭建后台管理前端"}},[t._v("#")]),t._v(" 1.搭建后台管理前端")]),t._v(" "),s("h2",{attrs:{id:"_1-1-导入已有资源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-导入已有资源"}},[t._v("#")]),t._v(" 1.1.导入已有资源")]),t._v(" "),s("p",[t._v("后台项目相对复杂，为了有利于教学，我们不再从0搭建项目，而是直接使用课前资料中给大家准备好的源码：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530555871804.png",alt:"1530555871804"}})]),t._v(" "),s("p",[t._v("我们解压缩，放到工作目录中：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530367369490.png",alt:"1530367369490"}})]),t._v(" "),s("p",[t._v("然后在Intellij idea中导入新的工程：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530367589197.png",alt:"1530367589197"}})]),t._v(" "),s("p",[t._v("选中我们的工程：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530367781173.png",alt:"1530367781173"}})]),t._v(" "),s("h2",{attrs:{id:"_1-2-安装依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-安装依赖"}},[t._v("#")]),t._v(" 1.2.安装依赖")]),t._v(" "),s("p",[t._v("你应该注意到，这里并没有node_modules文件夹，方便给大家下发，已经把依赖都删除了。不过package.json中依然定义了我们所需的一切依赖：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530368695265.png",alt:"1530368695265"}})]),t._v(" "),s("p",[t._v("我们只需要打开终端，进入项目目录，输入："),s("code",[t._v("npm install")]),t._v("命令，即可安装这些依赖。")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530374769782.png",alt:"1530374769782"}})]),t._v(" "),s("p",[t._v("大概需要几分钟。")]),t._v(" "),s("p",[s("strong",[t._v("如果安装过程出现以下问题")]),t._v("：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530374827792.png",alt:"1530374827792"}})]),t._v(" "),s("p",[t._v("建议删除node_modules目录，重新安装。或者copy其他人的node_modules使用")]),t._v(" "),s("h2",{attrs:{id:"_1-3-运行一下看看"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-运行一下看看"}},[t._v("#")]),t._v(" 1.3.运行一下看看")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1540706914029.png",alt:"1540706914029"}})]),t._v(" "),s("p",[t._v("在package.json文件中有scripts启动脚本配置，可以输入命令："),s("code",[t._v("npm run dev")]),t._v("或者"),s("code",[t._v("npm start")])]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530374954209.png",alt:"1530374954209"}})]),t._v(" "),s("p",[t._v("发现默认的端口是9001。访问：http://localhost:9001")]),t._v(" "),s("p",[t._v("会自动进行跳转：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530375152204.png",alt:"1525958950616"}})]),t._v(" "),s("h2",{attrs:{id:"_1-4-目录结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-目录结构"}},[t._v("#")]),t._v(" 1.4.目录结构")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1525962755237.png",alt:"1525962755237"}})]),t._v(" "),s("p",[t._v("webpack：是一个现代 JavaScript 应用程序的"),s("em",[t._v("静态模块打包器(module bundler)")]),t._v("。并且提供了前端项目的热部署插件。")]),t._v(" "),s("h2",{attrs:{id:"_1-5-调用关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-调用关系"}},[t._v("#")]),t._v(" 1.5.调用关系")]),t._v(" "),s("p",[t._v("我们最主要理清index.html、main.js、App.vue之间的关系：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1525964023585.png",alt:"1525964023585"}})]),t._v(" "),s("p",[t._v("理一下：")]),t._v(" "),s("ul",[s("li",[t._v("index.html：html模板文件。定义了空的"),s("code",[t._v("div")]),t._v("，其id为"),s("code",[t._v("app")]),t._v("。")]),t._v(" "),s("li",[t._v("main.js："),s("strong",[t._v("实例化vue对象")]),t._v("，并且通过id选择器绑定到index.html的div中，因此"),s("strong",[t._v("main.js的内容都将在index.html的div中显示")]),t._v("。main.js中使用了App组件，即App.vue，也就是说index.html中最终展现的是App.vue中的内容。index.html引用它之后，就拥有了vue的内容（包括组件、样式等），所以，main.js也是"),s("strong",[t._v("webpack打包的入口")]),t._v("。")]),t._v(" "),s("li",[t._v("index.js：定义请求路径和组件的映射关系。相当于之前的"),s("code",[t._v("<vue-router>")])]),t._v(" "),s("li",[t._v("App.vue中也没有内容，而是定义了vue-router的锚点："),s("code",[t._v("<router-view>")]),t._v(",我们之前讲过，vue-router路由后的组件将会在锚点展示。")]),t._v(" "),s("li",[t._v("最终结论："),s("strong",[t._v("一切路由后的内容都将通过App.vue在index.html中显示。")])]),t._v(" "),s("li",[t._v("访问流程：用户在浏览器输入路径，例如：http://localhost:9001/#/item/brand --\x3e index.js(/item/brand路径对应pages/item/Brand.vue组件) --\x3e 该组件显示在App.vue的锚点位置 --\x3e main.js使用了App.vue组件，并把该组件渲染在index.html文件中（id为“app”的div中）")])]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1543399927909.png",alt:"1543399927909"}})]),t._v(" "),s("h1",{attrs:{id:"_2-vuetify框架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-vuetify框架"}},[t._v("#")]),t._v(" 2.Vuetify框架")]),t._v(" "),s("h2",{attrs:{id:"_2-1-为什么要学习ui框架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-为什么要学习ui框架"}},[t._v("#")]),t._v(" 2.1.为什么要学习UI框架")]),t._v(" "),s("p",[t._v("Vue虽然会帮我们进行视图的渲染，但样式还是由我们自己来完成。这显然不是我们的强项，因此后端开发人员一般都喜欢使用一些现成的UI组件，拿来即用，常见的例如：")]),t._v(" "),s("ul",[s("li",[t._v("BootStrap")]),t._v(" "),s("li",[t._v("LayUI")]),t._v(" "),s("li",[t._v("EasyUI")]),t._v(" "),s("li",[t._v("ZUI")])]),t._v(" "),s("p",[t._v("然而这些UI组件的基因天生与Vue不合，因为他们更多的是利用DOM操作，借助于jQuery实现，而不是MVVM的思想。")]),t._v(" "),s("p",[t._v("而目前与Vue吻合的UI框架也非常的多，国内比较知名的如：")]),t._v(" "),s("ul",[s("li",[t._v("element-ui：饿了么出品")]),t._v(" "),s("li",[t._v("i-view：某公司出品")])]),t._v(" "),s("p",[t._v("然而我们都不用，我们今天推荐的是一款国外的框架：Vuetify")]),t._v(" "),s("p",[t._v("官方网站：https://vuetifyjs.com/zh-Hans/")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1525960652724.png",alt:"1525960652724"}})]),t._v(" "),s("h2",{attrs:{id:"_2-2-为什么是vuetify"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-为什么是vuetify"}},[t._v("#")]),t._v(" 2.2.为什么是Vuetify")]),t._v(" "),s("p",[t._v("有中国的为什么还要用外国的？原因如下：")]),t._v(" "),s("ul",[s("li",[t._v("Vuetify几乎不需要任何CSS代码，而element-ui许多布局样式需要我们来编写")]),t._v(" "),s("li",[t._v("Vuetify从底层构建起来的语义化组件。简单易学，容易记住。")]),t._v(" "),s("li",[t._v("Vuetify基于Material Design（谷歌推出的多平台设计规范），更加美观，动画效果酷炫，且风格统一")])]),t._v(" "),s("p",[t._v("这是官网的说明：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530555978248.png",alt:"1530555978248"}})]),t._v(" "),s("p",[t._v("缺陷：")]),t._v(" "),s("ul",[s("li",[t._v("目前官网虽然有中文文档，但因为翻译问题，几乎不太能看。")])]),t._v(" "),s("h2",{attrs:{id:"_2-3-怎么用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-怎么用"}},[t._v("#")]),t._v(" 2.3.怎么用？")]),t._v(" "),s("p",[t._v("基于官方网站的文档进行学习：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1525960312939.png",alt:"1525960312939"}})]),t._v(" "),s("p",[t._v("我们重点关注"),s("code",[t._v("UI components")]),t._v("即可，里面有大量的UI组件，我们要用的时候再查看，不用现在学习，先看下有什么：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1525961862771.png",alt:"1525961862771"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1525961875288.png",alt:"1525961875288"}})]),t._v(" "),s("p",[t._v("以后用到什么组件，就来查询即可。")]),t._v(" "),s("h2",{attrs:{id:"_2-4-项目页面布局"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-项目页面布局"}},[t._v("#")]),t._v(" 2.4.项目页面布局")]),t._v(" "),s("p",[t._v("接下来我们一起看下页面布局。")]),t._v(" "),s("p",[t._v("Layout组件是我们的整个页面的布局组件：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530380040278.png",alt:"1530380040278"}})]),t._v(" "),s("p",[t._v("一个典型的三块布局。包含左，上，中三部分：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1525965779366.png",alt:"1525965779366"}})]),t._v(" "),s("p",[t._v("里面使用了Vuetify中的2个组件和一个布局元素：")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("v-navigation-drawer")]),t._v(" ：导航抽屉，主要用于容纳应用程序中的页面的导航链接。")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1532577155616.png",alt:"1532577155616"}})])]),t._v(" "),s("li",[s("p",[s("code",[t._v("v-toolbar")]),t._v("：工具栏通常是网站导航的主要途径。可以与导航抽屉一起很好地工作，动态选择是否打开导航抽屉，实现可伸缩的侧边栏。")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530380292558.png",alt:"1530380292558"}})])]),t._v(" "),s("li",[s("p",[s("code",[t._v("v-content")]),t._v("：并不是一个组件，而是标记页面布局的元素。可以根据您指定的"),s("strong",[t._v("app")]),t._v("组件的结构动态调整大小，使得您可以创建高度可定制的组件。")])])]),t._v(" "),s("p",[t._v("那么问题来了："),s("code",[t._v("v-content")]),t._v("中的内容来自哪里？")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1525966180568.png",alt:"1525966180568"}})]),t._v(" "),s("ul",[s("li",[t._v("Layout映射的路径是"),s("code",[t._v("/")])]),t._v(" "),s("li",[t._v("除了Login以外的所有组件，都是定义在Layout的children属性，并且路径都是"),s("code",[t._v("/")]),t._v("的下面")]),t._v(" "),s("li",[t._v("因此当路由到子组件时，会在Layout中定义的锚点中显示。")]),t._v(" "),s("li",[t._v("并且Layout中的其它部分不会变化，这就实现了布局的共享。")])]),t._v(" "),s("h1",{attrs:{id:"_3-使用域名访问本地项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用域名访问本地项目"}},[t._v("#")]),t._v(" 3.使用域名访问本地项目")]),t._v(" "),s("h2",{attrs:{id:"_3-1-统一环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-统一环境"}},[t._v("#")]),t._v(" 3.1.统一环境")]),t._v(" "),s("p",[t._v("我们现在访问页面使用的是：http://localhost:9001")]),t._v(" "),s("p",[t._v("有没有什么问题？")]),t._v(" "),s("p",[t._v("实际开发中，会有不同的环境：")]),t._v(" "),s("ul",[s("li",[t._v("开发环境：自己的电脑")]),t._v(" "),s("li",[t._v("测试环境：提供给测试人员使用的环境")]),t._v(" "),s("li",[t._v("预发布环境：数据是和生成环境的数据一致，运行最新的项目代码进去测试")]),t._v(" "),s("li",[t._v("生产环境：项目最终发布上线的环境")])]),t._v(" "),s("p",[t._v("如果不同环境使用不同的ip去访问，可能会出现一些问题。为了保证所有环境的一致，我们会在各种环境下都使用域名来访问。")]),t._v(" "),s("p",[t._v("我们将使用以下域名：")]),t._v(" "),s("ul",[s("li",[t._v("主域名是：www.leyou.com，leyou.com")]),t._v(" "),s("li",[t._v("管理系统域名：manage.leyou.com")]),t._v(" "),s("li",[t._v("网关域名：api.leyou.com")]),t._v(" "),s("li",[t._v("...")])]),t._v(" "),s("p",[t._v("但是最终，我们希望这些域名指向的还是我们本机的某个端口。")]),t._v(" "),s("p",[t._v("那么，当我们在浏览器输入一个域名时，浏览器是如何找到对应服务的ip和端口的呢？")]),t._v(" "),s("h2",{attrs:{id:"_3-2-域名解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-域名解析"}},[t._v("#")]),t._v(" 3.2.域名解析")]),t._v(" "),s("p",[t._v("一个域名一定会被解析为一个或多个ip。这一般会包含两步：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("本地域名解析")]),t._v(" "),s("p",[t._v("浏览器会首先在本机的hosts文件中查找域名映射的IP地址，如果查找到就返回IP ，没找到则进行域名服务器解析，一般本地解析都会失败，因为默认这个文件是空的。")]),t._v(" "),s("ul",[s("li",[t._v("Windows下的hosts文件地址：C:/Windows/System32/drivers/etc/hosts")]),t._v(" "),s("li",[t._v("Linux下的hosts文件所在路径： /etc/hosts")])]),t._v(" "),s("p",[t._v("样式：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# My hosts\n127.0.0.1 localhost\n")])])])]),t._v(" "),s("li",[s("p",[t._v("域名服务器解析")]),t._v(" "),s("p",[t._v("本地解析失败，才会进行域名服务器解析，域名服务器就是网络中的一台计算机，里面记录了所有注册备案的域名和ip映射关系，一般只要域名是正确的，并且备案通过，一定能找到。")])])]),t._v(" "),s("h2",{attrs:{id:"_3-3-解决域名解析问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-解决域名解析问题"}},[t._v("#")]),t._v(" 3.3.解决域名解析问题")]),t._v(" "),s("p",[t._v("我们不可能去购买一个域名，因此我们可以伪造本地的hosts文件，实现对域名的解析。修改本地的host为：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("127.0.0.1 api.leyou.com\n127.0.0.1 manage.leyou.com\n")])])]),s("p",[t._v("这样就实现了域名的关系映射了。")]),t._v(" "),s("p",[t._v("每次在C盘寻找hosts文件并修改是非常麻烦的，给大家推荐一个快捷修改host的工具，在课前资料中可以找到：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530556073565.png",alt:"1530556073565"}})]),t._v(" "),s("p",[t._v("解压，运行exe文件，效果：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530382550630.png",alt:"1530382550630"}})]),t._v(" "),s("p",[t._v("我们添加了两个映射关系（中间用空格隔开）：")]),t._v(" "),s("ul",[s("li",[t._v("127.0.0.1 api.leyou.com ：我们的网关Zuul")]),t._v(" "),s("li",[t._v("127.0.0.1 manage.leyou.com：我们的后台系统地址")])]),t._v(" "),s("p",[t._v("现在，ping一下域名试试是否畅通：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530382601757.png",alt:"1530382601757"}})]),t._v(" "),s("p",[t._v("OK！")]),t._v(" "),s("p",[t._v("通过域名访问：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530383586463.png",alt:"1530383586463"}})]),t._v(" "),s("p",[t._v("原因：我们配置了项目访问的路径，虽然manage.leyou.com映射的ip也是127.0.0.1，但是webpack会验证host是否符合配置。")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530383612716.png",alt:"1530383612716"}})]),t._v(" "),s("p",[t._v("在webpack.dev.conf.js中取消host验证："),s("code",[t._v("disableHostCheck: true")])]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530383927461.png",alt:"1530383927461"}})]),t._v(" "),s("p",[t._v("重新执行"),s("code",[t._v("npm run dev")]),t._v("，刷新浏览器：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1532578408206.png",alt:"1532578408206"}})]),t._v(" "),s("p",[t._v("OK！")]),t._v(" "),s("h2",{attrs:{id:"_3-4-nginx解决端口问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-nginx解决端口问题"}},[t._v("#")]),t._v(" 3.4.nginx解决端口问题")]),t._v(" "),s("p",[t._v("域名问题解决了，但是现在要访问后台页面，还得自己加上端口："),s("code",[t._v("http://manage.taotao.com:9001")]),t._v("。")]),t._v(" "),s("p",[t._v("这就不够优雅了。我们希望的是直接域名访问："),s("code",[t._v("http://manage.taotao.com")]),t._v("。这种情况下端口默认是80，如何才能把请求转移到9001端口呢？")]),t._v(" "),s("p",[t._v("这里就要用到反向代理工具：Nginx")]),t._v(" "),s("h3",{attrs:{id:"_3-4-1-什么是nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-1-什么是nginx"}},[t._v("#")]),t._v(" 3.4.1.什么是Nginx")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526187409033.png",alt:"1526187409033"}})]),t._v(" "),s("p",[t._v("nginx可以作为web服务器，但更多的时候，我们把它作为网关，因为它具备网关必备的功能：")]),t._v(" "),s("ul",[s("li",[t._v("反向代理")]),t._v(" "),s("li",[t._v("负载均衡")]),t._v(" "),s("li",[t._v("动态路由")]),t._v(" "),s("li",[t._v("请求过滤")])]),t._v(" "),s("h3",{attrs:{id:"_3-4-2-nginx作为web服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-2-nginx作为web服务器"}},[t._v("#")]),t._v(" 3.4.2.nginx作为web服务器")]),t._v(" "),s("p",[t._v("Web服务器分2类：")]),t._v(" "),s("ul",[s("li",[t._v("web应用服务器，如：\n"),s("ul",[s("li",[t._v("tomcat")]),t._v(" "),s("li",[t._v("resin")]),t._v(" "),s("li",[t._v("jetty")])])]),t._v(" "),s("li",[t._v("web服务器，如：\n"),s("ul",[s("li",[t._v("Apache 服务器")]),t._v(" "),s("li",[t._v("Nginx")]),t._v(" "),s("li",[t._v("IIS")])])])]),t._v(" "),s("p",[t._v("区分：web服务器不能解析jsp等页面，只能处理js、css、html等静态资源。\n并发：web服务器的并发能力远高于web应用服务器。")]),t._v(" "),s("h3",{attrs:{id:"_3-4-3-nginx作为反向代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-3-nginx作为反向代理"}},[t._v("#")]),t._v(" 3.4.3.nginx作为反向代理")]),t._v(" "),s("p",[t._v("什么是反向代理？")]),t._v(" "),s("ul",[s("li",[t._v("代理：通过客户机的配置，实现让一台服务器代理客户机，客户的所有请求都交给代理服务器处理。")]),t._v(" "),s("li",[t._v("反向代理：用一台服务器，代理真实服务器，用户访问时，不再是访问真实服务器，而是代理服务器。")])]),t._v(" "),s("p",[t._v("nginx可以当做反向代理服务器来使用：")]),t._v(" "),s("ul",[s("li",[t._v("我们需要提前在nginx中配置好反向代理的规则，不同的请求，交给不同的真实服务器处理")]),t._v(" "),s("li",[t._v("当请求到达nginx，nginx会根据已经定义的规则进行请求的转发，从而实现路由功能")])]),t._v(" "),s("p",[t._v("利用反向代理，就可以解决我们前面所说的端口问题，如图")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526016663674.png",alt:"1526016663674"}})]),t._v(" "),s("h3",{attrs:{id:"_3-4-4-安装和使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-4-安装和使用"}},[t._v("#")]),t._v(" 3.4.4.安装和使用")]),t._v(" "),s("blockquote",[s("h3",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")])]),t._v(" "),s("p",[t._v("安装非常简单，把课前资料提供的nginx直接解压即可，绿色免安装，舒服！")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/0C36B84E.gif",alt:"img"}})]),t._v(" "),s("p",[t._v("我们在本地安装一台nginx：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530556268445.png",alt:"1530556268445"}})]),t._v(" "),s("p",[t._v("解压后，目录结构：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530384792790.png",alt:"1530384792790"}})]),t._v(" "),s("ol",[s("li",[t._v("conf：配置目录")]),t._v(" "),s("li",[t._v("contrib：第三方依赖")]),t._v(" "),s("li",[t._v("html：默认的静态资源目录，类似于tomcat的webapps")]),t._v(" "),s("li",[t._v("logs：日志目录")]),t._v(" "),s("li",[t._v("nginx.exe：启动程序。可双击运行，但不建议这么做。")])]),t._v(" "),s("blockquote",[s("h3",{attrs:{id:"反向代理配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#反向代理配置"}},[t._v("#")]),t._v(" 反向代理配置")])]),t._v(" "),s("p",[t._v("示例：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526188831504.png",alt:"1526188831504"}})]),t._v(" "),s("p",[t._v("nginx中的每个server就是一个反向代理配置，可以有多个server")]),t._v(" "),s("p",[t._v("完整配置：")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#user  nobody;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("worker_processes")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("events")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("worker_connections")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("include")]),t._v("       mime.types")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default_type")]),t._v("  application/octet-stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sendfile")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   \n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("keepalive_timeout")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  manage.leyou.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Forwarded-Host "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Forwarded-Server "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Forwarded-For "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:9001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_connect_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_read_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  api.leyou.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Forwarded-Host "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Forwarded-Server "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Forwarded-For "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:10010")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_connect_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_read_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("blockquote",[s("h3",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")])]),t._v(" "),s("p",[t._v("nginx可以通过命令行来启动，操作命令：")]),t._v(" "),s("ul",[s("li",[t._v("启动："),s("code",[t._v("start nginx.exe")])]),t._v(" "),s("li",[t._v("停止："),s("code",[t._v("nginx.exe -s stop")])]),t._v(" "),s("li",[t._v("重新加载："),s("code",[t._v("nginx.exe -s reload")])])]),t._v(" "),s("p",[t._v("启动过程会闪烁一下，启动成功后，任务管理器中会有两个nginx进程：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1532579488518.png",alt:"1532579488518"}})]),t._v(" "),s("h2",{attrs:{id:"_3-5-测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-测试"}},[t._v("#")]),t._v(" 3.5.测试")]),t._v(" "),s("p",[t._v("启动nginx，然后用域名访问后台管理系统：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530385593052.png",alt:"1530385593052"}})]),t._v(" "),s("p",[t._v("现在实现了域名访问网站了，中间的流程是怎样的呢？")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526189945180.png",alt:"1526189945180"}})]),t._v(" "),s("ol",[s("li",[s("p",[t._v("浏览器准备发起请求，访问http://mamage.leyou.com，但需要进行域名解析")])]),t._v(" "),s("li",[s("p",[t._v("优先进行本地域名解析，因为我们修改了hosts，所以解析成功，得到地址：127.0.0.1")])]),t._v(" "),s("li",[s("p",[t._v("请求被发往解析得到的ip，并且默认使用80端口：http://127.0.0.1:80")]),t._v(" "),s("p",[t._v("本机的nginx一直监听80端口，因此捕获这个请求")])]),t._v(" "),s("li",[s("p",[t._v("nginx中配置了反向代理规则，将manage.leyou.com代理到127.0.0.1:9001，因此请求被转发")])]),t._v(" "),s("li",[s("p",[t._v("后台系统的webpack server监听的端口是9001，得到请求并处理，完成后将响应返回到nginx")])]),t._v(" "),s("li",[s("p",[t._v("nginx将得到的结果返回到浏览器")])])]),t._v(" "),s("h1",{attrs:{id:"_4-实现商品分类查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-实现商品分类查询"}},[t._v("#")]),t._v(" 4.实现商品分类查询")]),t._v(" "),s("p",[t._v("商城的核心自然是商品，而商品多了以后，肯定要进行分类，并且不同的商品会有不同的品牌信息，我们需要依次去完成：商品分类、品牌、商品的开发。")]),t._v(" "),s("h2",{attrs:{id:"_4-1-导入数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-导入数据"}},[t._v("#")]),t._v(" 4.1.导入数据")]),t._v(" "),s("p",[t._v("首先导入课前资料提供的sql：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530556389224.png",alt:"1530556389224"}})]),t._v(" "),s("p",[t._v("我们先看商品分类表：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1525999774439.png",alt:"1525999774439"}})]),t._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("CREATE TABLE `tb_category` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '类目id',\n  `name` varchar(20) NOT NULL COMMENT '类目名称',\n  `parent_id` bigint(20) NOT NULL COMMENT '父类目id,顶级类目填0',\n  `is_parent` tinyint(1) NOT NULL COMMENT '是否为父节点，0为否，1为是',\n  `sort` int(4) NOT NULL COMMENT '排序指数，越小越靠前',\n  PRIMARY KEY (`id`),\n  KEY `key_parent_id` (`parent_id`) USING BTREE\n) ENGINE=InnoDB AUTO_INCREMENT=1424 DEFAULT CHARSET=utf8 COMMENT='商品类目表，类目和商品(spu)是一对多关系，类目与品牌是多对多关系';\n")])])]),s("p",[t._v("因为商品分类会有层级关系，因此这里我们加入了"),s("code",[t._v("parent_id")]),t._v("字段，对本表中的其它分类进行自关联。")]),t._v(" "),s("h2",{attrs:{id:"_4-2-实现功能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-实现功能"}},[t._v("#")]),t._v(" 4.2.实现功能")]),t._v(" "),s("p",[t._v("在浏览器页面点击“分类管理”菜单：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1545220121941.png",alt:"1545220121941"}})]),t._v(" "),s("p",[t._v("根据这个路由路径到路由文件（src/route/index.js），可以定位到分类管理页面：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1545220316442.png",alt:"1545220316442"}})]),t._v(" "),s("p",[t._v("由路由文件知，页面是src/pages/item/Category.vue")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1545220394460.png",alt:"1545220394460"}})]),t._v(" "),s("p",[t._v("商品分类使用了树状结构，而这种结构的组件vuetify并没有为我们提供，这里自定义了一个树状组件。不要求实现或者查询组件的实现，只要求可以参照文档使用该组件即可：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1545219777406.png",alt:"1545219777406"}})]),t._v(" "),s("h3",{attrs:{id:"_4-2-1-url异步请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-url异步请求"}},[t._v("#")]),t._v(" 4.2.1.url异步请求")]),t._v(" "),s("p",[t._v("点击商品管理下的分类管理子菜单，在浏览器控制台可以看到：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530427294644.png",alt:"1530427294644"}})]),t._v(" "),s("p",[t._v("页面中没有，只是发起了一条请求：http://api.leyou.com/api/item/category/list?pid=0")]),t._v(" "),s("p",[t._v("大家可能会觉得很奇怪，我们明明是使用的相对路径：/item/category/list，讲道理发起的请求地址应该是：")]),t._v(" "),s("p",[t._v("http://manage.leyou.com/item/category/list")]),t._v(" "),s("p",[t._v("但实际却是：")]),t._v(" "),s("p",[t._v("http://api.leyou.com/api/item/category/list?pid=0")]),t._v(" "),s("p",[t._v("这是因为，我们有一个全局的配置文件，对所有的请求路径进行了约定：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530427514123.png",alt:"1530427514123"}})]),t._v(" "),s("p",[t._v("路径是http://api.leyou.com，并且默认加上了/api的前缀，这恰好与我们的网关设置匹配，我们只需要把地址改成网关的地址即可,因为我们使用了nginx反向代理，这里可以写域名。")]),t._v(" "),s("p",[t._v("接下来，我们要做的事情就是编写后台接口，返回对应的数据即可。")]),t._v(" "),s("h3",{attrs:{id:"_4-2-2-实体类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-实体类"}},[t._v("#")]),t._v(" 4.2.2.实体类")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("leyou-item-interface")]),t._v("中添加category实体类：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530444682670.png",alt:"1530444682670"}})]),t._v(" "),s("p",[t._v("内容：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Table")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tb_category"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Category")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Id")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GeneratedValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("strategy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GenerationType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("IDENTITY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" parentId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Boolean")]),t._v(" isParent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意isParent生成的getter和setter方法需要手动加上Is")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// getter和setter略")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("需要注意的是，这里要用到jpa的注解，因此我们在"),s("code",[t._v("leyou-item-iterface")]),t._v("中添加jpa依赖")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("javax.persistence"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("persistence-api"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.0"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-2-3-controller"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-controller"}},[t._v("#")]),t._v(" 4.2.3.controller")]),t._v(" "),s("p",[t._v("编写一个controller一般需要知道四个内容：")]),t._v(" "),s("ul",[s("li",[t._v("请求方式：决定我们用GetMapping还是PostMapping")]),t._v(" "),s("li",[t._v("请求路径：决定映射路径")]),t._v(" "),s("li",[t._v("请求参数：决定方法的参数")]),t._v(" "),s("li",[t._v("返回值结果：决定方法的返回值")])]),t._v(" "),s("p",[t._v("在刚才页面发起的请求中，我们就能得到绝大多数信息：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530445885707.png",alt:"1530445885707"}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("请求方式：Get，插叙肯定是get请求")])]),t._v(" "),s("li",[s("p",[t._v("请求路径：/api/item/category/list。其中/api是网关前缀，/item是网关的路由映射，真实的路径应该是/category/list")])]),t._v(" "),s("li",[s("p",[t._v("请求参数：pid=0，根据tree组件的说明，应该是父节点的id，第一次查询为0，那就是查询一级类目")])]),t._v(" "),s("li",[s("p",[t._v("返回结果：？？")]),t._v(" "),s("p",[t._v("根据前面tree组件的用法我们知道，返回的应该是json数组：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("74")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"手机"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"parentId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"isParent"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sort"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("75")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"家用电器"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"parentId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"isParent"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sort"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("对应的java类型可以是List集合，里面的元素就是类目对象了。也就是"),s("code",[t._v("List<Category>")])])])]),t._v(" "),s("p",[t._v("添加Controller：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530450599897.png",alt:"1530450599897"}})]),t._v(" "),s("p",[t._v("controller代码：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Controller")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestMapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"category"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CategoryController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CategoryService")]),t._v(" categoryService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 根据父id查询子节点\n     * @param pid\n     * @return\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"list"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseEntity")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Category")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryCategoriesByPid")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestParam")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pid"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("longValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 响应400，相当于ResponseEntity.status(HttpStatus.BAD_REQUEST).build();")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseEntity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("badRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Category")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" categories "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("categoryService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryCategoriesByPid")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CollectionUtils")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEmpty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("categories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 响应404")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseEntity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("notFound")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseEntity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ok")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("categories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-2-4-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-service"}},[t._v("#")]),t._v(" 4.2.4.service")]),t._v(" "),s("p",[t._v("一般service层我们会定义接口和实现类，不过这里我们就偷懒一下，直接写实现类了：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530450744567.png",alt:"1530450744567"}})]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Service")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CategoryService")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CategoryMapper")]),t._v(" categoryMapper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 根据parentId查询子类目\n     * @param pid\n     * @return\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Category")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryCategoriesByPid")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Category")]),t._v(" record "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Category")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        record"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setParentId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("categoryMapper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("record"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-2-5-mapper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-5-mapper"}},[t._v("#")]),t._v(" 4.2.5.mapper")]),t._v(" "),s("p",[t._v("我们使用通用mapper来简化开发：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CategoryMapper")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mapper")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Category")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("要注意，我们并没有在mapper接口上声明@Mapper注解，那么mybatis如何才能找到接口呢？")]),t._v(" "),s("p",[t._v("我们在启动类上添加一个扫描包功能：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SpringBootApplication")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableDiscoveryClient")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@MapperScan")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"com.leyou.item.mapper"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mapper接口的包扫描")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LeyouItemServiceApplication")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringApplication")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LeyouItemServiceApplication")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-2-6-启动并测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-6-启动并测试"}},[t._v("#")]),t._v(" 4.2.6.启动并测试")]),t._v(" "),s("p",[t._v("我们不经过网关，直接访问：http://localhost:8081/category/list")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530455133230.png",alt:"1530455133230"}})]),t._v(" "),s("p",[t._v("然后试试网关是否畅通：http://api.leyou.com/api/item/category/list")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530455291468.png",alt:"1530455291468"}})]),t._v(" "),s("p",[t._v("一切OK！")]),t._v(" "),s("p",[t._v("然后刷新后台管理页面查看：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530455437899.png",alt:"1530455437899"}})]),t._v(" "),s("p",[t._v("发现报错了！")]),t._v(" "),s("p",[t._v("浏览器直接访问没事，但是这里却报错，什么原因？")]),t._v(" "),s("p",[t._v("这其实是浏览器的同源策略造成的跨域问题。")]),t._v(" "),s("h1",{attrs:{id:"_5-跨域问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-跨域问题"}},[t._v("#")]),t._v(" 5.跨域问题")]),t._v(" "),s("p",[t._v("跨域：浏览器对于javascript的同源策略的限制 。")]),t._v(" "),s("p",[t._v("以下情况都属于跨域：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("跨域原因说明")]),t._v(" "),s("th",[t._v("示例")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("域名不同")]),t._v(" "),s("td",[s("code",[t._v("www.jd.com")]),t._v(" 与 "),s("code",[t._v("www.taobao.com")])])]),t._v(" "),s("tr",[s("td",[t._v("域名相同，端口不同")]),t._v(" "),s("td",[s("code",[t._v("www.jd.com:8080")]),t._v(" 与 "),s("code",[t._v("www.jd.com:8081")])])]),t._v(" "),s("tr",[s("td",[t._v("二级域名不同")]),t._v(" "),s("td",[s("code",[t._v("item.jd.com")]),t._v(" 与 "),s("code",[t._v("miaosha.jd.com")])])])])]),t._v(" "),s("p",[t._v("如果"),s("strong",[t._v("域名和端口都相同，但是请求路径不同")]),t._v("，不属于跨域，如：")]),t._v(" "),s("p",[s("code",[t._v("www.jd.com/item")])]),t._v(" "),s("p",[s("code",[t._v("www.jd.com/goods")])]),t._v(" "),s("p",[t._v("http和https也属于跨域")]),t._v(" "),s("p",[t._v("而我们刚才是从"),s("code",[t._v("manage.leyou.com")]),t._v("去访问"),s("code",[t._v("api.leyou.com")]),t._v("，这属于二级域名不同，跨域了。")]),t._v(" "),s("h2",{attrs:{id:"_5-1-为什么有跨域问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-为什么有跨域问题"}},[t._v("#")]),t._v(" 5.1.为什么有跨域问题？")]),t._v(" "),s("p",[t._v("跨域不一定都会有跨域问题。")]),t._v(" "),s("p",[t._v("因为跨域问题是浏览器对于ajax请求的一种安全限制："),s("strong",[t._v("一个页面发起的ajax请求，只能是与当前页域名相同的路径")]),t._v("，这能有效的阻止跨站攻击。")]),t._v(" "),s("p",[t._v("因此："),s("strong",[t._v("跨域问题 是针对ajax的一种限制")]),t._v("。")]),t._v(" "),s("p",[t._v("但是这却给我们的开发带来了不便，而且在实际生产环境中，肯定会有很多台服务器之间交互，地址和端口都可能不同，怎么办？")]),t._v(" "),s("h2",{attrs:{id:"_5-2-解决跨域问题的方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-解决跨域问题的方案"}},[t._v("#")]),t._v(" 5.2.解决跨域问题的方案")]),t._v(" "),s("p",[t._v("目前比较常用的跨域解决方案有3种：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Jsonp")]),t._v(" "),s("p",[t._v("最早的解决方案，利用script标签可以跨域的原理实现。")]),t._v(" "),s("p",[t._v("限制：")]),t._v(" "),s("ul",[s("li",[t._v("需要服务的支持")]),t._v(" "),s("li",[t._v("只能发起GET请求")])])]),t._v(" "),s("li",[s("p",[t._v("nginx反向代理")]),t._v(" "),s("p",[t._v("思路是：利用nginx把跨域反向代理为不跨域，支持各种请求方式")]),t._v(" "),s("p",[t._v("缺点：需要在nginx进行额外配置，语义不清晰")])]),t._v(" "),s("li",[s("p",[t._v("CORS")]),t._v(" "),s("p",[t._v("规范化的跨域请求解决方案，安全可靠。")]),t._v(" "),s("p",[t._v("优势：")]),t._v(" "),s("ul",[s("li",[t._v("在服务端进行控制是否允许跨域，可自定义规则")]),t._v(" "),s("li",[t._v("支持各种请求方式")])]),t._v(" "),s("p",[t._v("缺点：")]),t._v(" "),s("ul",[s("li",[t._v("会产生额外的请求")])])])]),t._v(" "),s("p",[t._v("我们这里会采用cors的跨域方案。")]),t._v(" "),s("h2",{attrs:{id:"_5-3-cors解决跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-cors解决跨域"}},[t._v("#")]),t._v(" 5.3.cors解决跨域")]),t._v(" "),s("h3",{attrs:{id:"_5-3-1-什么是cors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-1-什么是cors"}},[t._v("#")]),t._v(" 5.3.1.什么是cors")]),t._v(" "),s("p",[t._v('CORS是一个W3C标准，全称是"跨域资源共享"（Cross-origin resource sharing）。')]),t._v(" "),s("p",[t._v("它允许浏览器向跨源服务器，发出"),s("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2012/09/xmlhttprequest_level_2.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("XMLHttpRequest")]),s("OutboundLink")],1),t._v("请求，从而克服了AJAX只能"),s("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("同源"),s("OutboundLink")],1),t._v("使用的限制。")]),t._v(" "),s("p",[t._v("CORS需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("浏览器端：")]),t._v(" "),s("p",[t._v("目前，所有浏览器都支持该功能（IE10以下不行）。整个CORS通信过程，都是浏览器自动完成，不需要用户参与。")])]),t._v(" "),s("li",[s("p",[t._v("服务端：")]),t._v(" "),s("p",[t._v("CORS通信与AJAX没有任何差别，因此你不需要改变以前的业务逻辑。只不过，浏览器会在请求中携带一些头信息，我们需要以此判断是否允许其跨域，然后在响应头中加入一些信息即可。这一般通过过滤器完成即可。")])])]),t._v(" "),s("h3",{attrs:{id:"_5-3-2-原理有点复杂"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-原理有点复杂"}},[t._v("#")]),t._v(" 5.3.2.原理有点复杂")]),t._v(" "),s("p",[t._v("浏览器会将ajax请求分为两类，其处理方案略有差异：简单请求、特殊请求。")]),t._v(" "),s("h4",{attrs:{id:"_5-3-2-1-简单请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-1-简单请求"}},[t._v("#")]),t._v(" 5.3.2.1.简单请求")]),t._v(" "),s("p",[t._v("只要同时满足以下两大条件，就属于简单请求。：")]),t._v(" "),s("p",[t._v("（1) 请求方法是以下三种方法之一：")]),t._v(" "),s("ul",[s("li",[t._v("HEAD")]),t._v(" "),s("li",[t._v("GET")]),t._v(" "),s("li",[t._v("POST")])]),t._v(" "),s("p",[t._v("（2）HTTP的头信息不超出以下几种字段：")]),t._v(" "),s("ul",[s("li",[t._v("Accept")]),t._v(" "),s("li",[t._v("Accept-Language")]),t._v(" "),s("li",[t._v("Content-Language")]),t._v(" "),s("li",[t._v("Last-Event-ID")]),t._v(" "),s("li",[t._v("Content-Type：只限于三个值"),s("code",[t._v("application/x-www-form-urlencoded")]),t._v("、"),s("code",[t._v("multipart/form-data")]),t._v("、"),s("code",[t._v("text/plain")])])]),t._v(" "),s("p",[t._v("当浏览器发现发起的ajax请求是简单请求时，会在请求头中携带一个字段："),s("code",[t._v("Origin")]),t._v(".")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530460311064.png",alt:"1530460311064"}})]),t._v(" "),s("p",[t._v("Origin中会指出当前请求属于哪个域（协议+域名+端口）。服务会根据这个值决定是否允许其跨域。")]),t._v(" "),s("p",[t._v("如果服务器允许跨域，需要在返回的响应头中携带下面信息：")]),t._v(" "),s("div",{staticClass:"language-http extra-class"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Allow-Origin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("http://manage.leyou.com")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Allow-Credentials")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("true")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("text/html; charset=utf-8")])]),t._v("\n")])])]),s("ul",[s("li",[t._v("Access-Control-Allow-Origin：可接受的域，是一个具体域名或者*（代表任意域名）")]),t._v(" "),s("li",[t._v("Access-Control-Allow-Credentials：是否允许携带cookie，默认情况下，cors不会携带cookie，除非这个值是true")])]),t._v(" "),s("blockquote",[s("p",[t._v("有关cookie：")])]),t._v(" "),s("p",[t._v("要想操作cookie，需要满足3个条件：")]),t._v(" "),s("ul",[s("li",[t._v("服务的响应头中需要携带Access-Control-Allow-Credentials并且为true。")]),t._v(" "),s("li",[t._v("浏览器发起ajax需要指定withCredentials 为true")]),t._v(" "),s("li",[t._v("响应头中的Access-Control-Allow-Origin一定不能为*，必须是指定的域名")])]),t._v(" "),s("h4",{attrs:{id:"_5-3-2-2-特殊请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-2-特殊请求"}},[t._v("#")]),t._v(" 5.3.2.2.特殊请求")]),t._v(" "),s("p",[t._v("不符合简单请求的条件，会被浏览器判定为特殊请求,，例如请求方式为PUT。")]),t._v(" "),s("blockquote",[s("p",[t._v("预检请求")])]),t._v(" "),s("p",[t._v('特殊请求会在正式通信之前，增加一次HTTP查询请求，称为"预检"请求（preflight）。')]),t._v(" "),s("p",[t._v("浏览器先询问服务器，当前网页所在的域名是否在服务器的许可名单之中，以及可以使用哪些HTTP动词和头信息字段。只有得到肯定答复，浏览器才会发出正式的"),s("code",[t._v("XMLHttpRequest")]),t._v("请求，否则就报错。")]),t._v(" "),s("p",[t._v("一个“预检”请求的样板：")]),t._v(" "),s("div",{staticClass:"language-http extra-class"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[s("span",{pre:!0,attrs:{class:"token request-line"}},[s("span",{pre:!0,attrs:{class:"token method property"}},[t._v("OPTIONS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token request-target url"}},[t._v("/cors")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Origin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("http://manage.leyou.com")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Request-Method")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("PUT")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Request-Headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("X-Custom-Header")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("api.leyou.com")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept-Language")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("en-US")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Connection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("keep-alive")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("User-Agent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("Mozilla/5.0...")])]),t._v("\n")])])]),s("p",[t._v("与简单请求相比，除了Origin以外，多了两个头：")]),t._v(" "),s("ul",[s("li",[t._v("Access-Control-Request-Method：接下来会用到的请求方式，比如PUT")]),t._v(" "),s("li",[t._v("Access-Control-Request-Headers：会额外用到的头信息")])]),t._v(" "),s("blockquote",[s("p",[t._v("预检请求的响应")])]),t._v(" "),s("p",[t._v("服务的收到预检请求，如果许可跨域，会发出响应：")]),t._v(" "),s("div",{staticClass:"language-http extra-class"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[s("span",{pre:!0,attrs:{class:"token response-status"}},[s("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token status-code number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token reason-phrase string"}},[t._v("OK")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("Mon, 01 Dec 2008 01:15:39 GMT")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("Apache/2.0.61 (Unix)")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Allow-Origin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("http://manage.leyou.com")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Allow-Credentials")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("true")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Allow-Methods")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("GET, POST, PUT")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Allow-Headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("X-Custom-Header")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Max-Age")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("1728000")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("text/html; charset=utf-8")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Encoding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("gzip")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Length")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("0")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Keep-Alive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("timeout=2, max=100")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Connection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("Keep-Alive")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("text/plain")])]),t._v("\n")])])]),s("p",[t._v("除了"),s("code",[t._v("Access-Control-Allow-Origin")]),t._v("和"),s("code",[t._v("Access-Control-Allow-Credentials")]),t._v("以外，这里又额外多出3个头：")]),t._v(" "),s("ul",[s("li",[t._v("Access-Control-Allow-Methods：允许访问的方式")]),t._v(" "),s("li",[t._v("Access-Control-Allow-Headers：允许携带的头")]),t._v(" "),s("li",[t._v("Access-Control-Max-Age：本次许可的有效时长，单位是秒，"),s("strong",[t._v("过期之前的ajax请求就无需再次进行预检了")])])]),t._v(" "),s("p",[t._v("如果浏览器得到上述响应，则认定为可以跨域，后续就跟简单请求的处理是一样的了。")]),t._v(" "),s("h3",{attrs:{id:"_5-3-3-实现非常简单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-3-实现非常简单"}},[t._v("#")]),t._v(" 5.3.3.实现非常简单")]),t._v(" "),s("p",[t._v("虽然原理比较复杂，但是前面说过：")]),t._v(" "),s("ul",[s("li",[t._v("浏览器端都有浏览器自动完成，我们无需操心")]),t._v(" "),s("li",[t._v("服务端可以通过拦截器统一实现，不必每次都去进行跨域判定的编写。")])]),t._v(" "),s("p",[t._v("事实上，SpringMVC已经帮我们写好了CORS的跨域过滤器：CorsFilter ,内部已经实现了刚才所讲的判定逻辑，我们直接用就好了。")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("leyou-gateway")]),t._v("中编写一个配置类，并且注册CorsFilter：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Bean")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Configuration")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CorsConfiguration")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UrlBasedCorsConfigurationSource")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("filter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CorsFilter")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LeyouCorsConfig")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CorsFilter")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("corsFilter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1.添加CORS配置信息")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CorsConfiguration")]),t._v(" config "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CorsConfiguration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1) 允许的域,不要写*，否则cookie就无法使用了")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAllowedOrigin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://manage.leyou.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2) 是否发送Cookie信息")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAllowCredentials")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3) 允许的请求方式")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAllowedMethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OPTIONS"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAllowedMethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HEAD"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAllowedMethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAllowedMethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PUT"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAllowedMethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"POST"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAllowedMethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DELETE"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAllowedMethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PATCH"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4）允许的头信息")]),t._v("\n        config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAllowedHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2.添加映射路径，我们拦截一切请求")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UrlBasedCorsConfigurationSource")]),t._v(" configSource "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UrlBasedCorsConfigurationSource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        configSource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerCorsConfiguration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/**"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3.返回新的CorsFilter.")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CorsFilter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("configSource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("结构：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530462650711.png",alt:"1530462650711"}})]),t._v(" "),s("p",[t._v("重启测试，访问正常：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530463010927.png",alt:"1530463010927"}})]),t._v(" "),s("p",[t._v("分类的增删改功能暂时就不做了，页面已经预留好了事件接口，有兴趣的同学可以完成一下。")]),t._v(" "),s("h1",{attrs:{id:"_6-品牌的查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-品牌的查询"}},[t._v("#")]),t._v(" 6.品牌的查询")]),t._v(" "),s("p",[t._v("商品分类完成以后，自然轮到了品牌功能了。")]),t._v(" "),s("p",[t._v("先看看我们要实现的效果：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526021968036.png",alt:"1526021968036"}})]),t._v(" "),s("p",[t._v("点击“品牌管理”菜单：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1545221218980.png",alt:"1545221218980"}})]),t._v(" "),s("p",[t._v("路由路径：/item/brand")]),t._v(" "),s("p",[t._v("根据路由文件知，对应的页面是：src/pages/item/Brand.vue")]),t._v(" "),s("p",[t._v("页面会发送如下请求：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1543066995215.png",alt:"1543066995215"}})]),t._v(" "),s("h2",{attrs:{id:"_6-1-后台提供查询接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-后台提供查询接口"}},[t._v("#")]),t._v(" 6.1.后台提供查询接口")]),t._v(" "),s("p",[t._v("前台页面已经准备好，接下来就是后台提供数据接口了。")]),t._v(" "),s("h3",{attrs:{id:"_6-1-1-数据库表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-1-数据库表"}},[t._v("#")]),t._v(" 6.1.1.数据库表")]),t._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("CREATE TABLE `tb_brand` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '品牌id',\n  `name` varchar(50) NOT NULL COMMENT '品牌名称',\n  `image` varchar(200) DEFAULT '' COMMENT '品牌图片地址',\n  `letter` char(1) DEFAULT '' COMMENT '品牌的首字母',\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=325400 DEFAULT CHARSET=utf8 COMMENT='品牌表，一个品牌下有多个商品（spu），一对多关系';\n")])])]),s("p",[t._v("简单的四个字段，不多解释。")]),t._v(" "),s("p",[t._v("这里需要注意的是，品牌和商品分类之间是多对多关系。因此我们有一张中间表，来维护两者间关系：")]),t._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("CREATE TABLE `tb_category_brand` (\n  `category_id` bigint(20) NOT NULL COMMENT '商品类目id',\n  `brand_id` bigint(20) NOT NULL COMMENT '品牌id',\n  PRIMARY KEY (`category_id`,`brand_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='商品分类和品牌的中间表，两者是多对多关系';\n\n")])])]),s("p",[t._v("但是，你可能会发现，这张表中并"),s("strong",[t._v("没有设置外键约束")]),t._v("，似乎与数据库的设计范式不符。为什么这么做？")]),t._v(" "),s("ul",[s("li",[t._v("外键会严重影响数据库读写的效率")]),t._v(" "),s("li",[t._v("数据删除时会比较麻烦")])]),t._v(" "),s("p",[t._v("在电商行业，性能是非常重要的。我们宁可在代码中通过逻辑来维护表关系，也不设置外键。")]),t._v(" "),s("h3",{attrs:{id:"_6-1-2-实体类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-2-实体类"}},[t._v("#")]),t._v(" 6.1.2.实体类")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530541070271.png",alt:"1530541070271"}})]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Table")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tb_brand"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Brand")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Id")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GeneratedValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("strategy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GenerationType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("IDENTITY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 品牌名称")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" image"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 品牌图片")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Character")]),t._v(" letter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// getter setter 略")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-1-3-mapper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-3-mapper"}},[t._v("#")]),t._v(" 6.1.3.mapper")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530541222679.png",alt:"1530541222679"}})]),t._v(" "),s("p",[t._v("通用mapper来简化开发：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BrandMapper")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mapper")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Brand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-1-4-controller"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-4-controller"}},[t._v("#")]),t._v(" 6.1.4.controller")]),t._v(" "),s("p",[t._v("编写controller先思考四个问题，参照前端页面的控制台")]),t._v(" "),s("ul",[s("li",[t._v("请求方式：查询，肯定是Get")]),t._v(" "),s("li",[t._v("请求路径：分页查询，/brand/page")]),t._v(" "),s("li",[t._v("请求参数：根据我们刚才编写的页面，有分页功能，有排序功能，有搜索过滤功能，因此至少要有5个参数：\n"),s("ul",[s("li",[t._v("page：当前页，int")]),t._v(" "),s("li",[t._v("rows：每页大小，int")]),t._v(" "),s("li",[t._v("sortBy：排序字段，String")]),t._v(" "),s("li",[t._v("desc：是否为降序，boolean")]),t._v(" "),s("li",[t._v("key：搜索关键词，String")])])]),t._v(" "),s("li",[t._v("响应结果：分页结果一般至少需要两个数据\n"),s("ul",[s("li",[t._v("total：总条数")]),t._v(" "),s("li",[t._v("items：当前页数据")]),t._v(" "),s("li",[t._v("totalPage：有些还需要总页数")])])])]),t._v(" "),s("p",[t._v("这里我们封装一个类，来表示分页结果：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageResult")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" total"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 总条数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" totalPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 总页数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当前页数据")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" total"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("total "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" total"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("items "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" total"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" totalPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("total "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" total"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("totalPage "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" totalPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("items "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTotal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" total"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTotal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" total"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("total "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" total"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getItems")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setItems")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("items "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTotalPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" totalPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTotalPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" totalPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("totalPage "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" totalPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("另外，这个PageResult以后可能在其它项目中也有需求，因此我们将其抽取到"),s("code",[t._v("leyou-common")]),t._v("中，提高复用性：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530543778541.png",alt:"1530543778541"}})]),t._v(" "),s("p",[s("strong",[t._v("不要忘记在leyou-item-service工程的pom.xml中引入leyou-common的依赖")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.leyou.common"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("leyou-common"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.0.0-SNAPSHOT"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("接下来，我们编写Controller")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530549253999.png",alt:"1530549253999"}})]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RestController")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestMapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"brand"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BrandController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BrandService")]),t._v(" brandService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 根据查询条件分页并排序查询品牌信息\n     * @param key\n     * @param page\n     * @param rows\n     * @param sortBy\n     * @param desc\n     * @return\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"page"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseEntity")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Brand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryBrandsByPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestParam")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" required "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestParam")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"page"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" defaultValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestParam")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rows"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" defaultValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" rows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestParam")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sortBy"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" required "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" sortBy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestParam")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"desc"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" required "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Boolean")]),t._v(" desc\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageResult")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Brand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("brandService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryBrandsByPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sortBy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" desc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CollectionUtils")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEmpty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getItems")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseEntity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("notFound")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseEntity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ok")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-1-5-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-5-service"}},[t._v("#")]),t._v(" 6.1.5.Service")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Service")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BrandService")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BrandMapper")]),t._v(" brandMapper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 根据查询条件分页并排序查询品牌信息\n     *\n     * @param key\n     * @param page\n     * @param rows\n     * @param sortBy\n     * @param desc\n     * @return\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageResult")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Brand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryBrandsByPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" rows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" sortBy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Boolean")]),t._v(" desc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化example对象")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Example")]),t._v(" example "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Example")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Brand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Criteria")]),t._v(" criteria "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createCriteria")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 根据name模糊查询，或者根据首字母查询")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringUtils")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isNotBlank")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            criteria"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("andLike")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("orEqualTo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"letter"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加分页条件")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageHelper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加排序条件")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringUtils")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isNotBlank")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sortBy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setOrderByClause")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sortBy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("desc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"desc"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"asc"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Brand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" brands "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("brandMapper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("selectByExample")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 包装成pageInfo")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageInfo")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Brand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" pageInfo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageInfo")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("brands"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 包装成分页结果集返回")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageResult")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pageInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTotal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pageInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-1-6-测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-6-测试"}},[t._v("#")]),t._v(" 6.1.6.测试")]),t._v(" "),s("p",[t._v("通过浏览器访问试试：http://api.leyou.com/api/item/brand/page")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530549095150.png",alt:"1530549095150"}})]),t._v(" "),s("p",[t._v("接下来，去页面请求数据并渲染")]),t._v(" "),s("h2",{attrs:{id:"_6-2-异步查询工具axios"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-异步查询工具axios"}},[t._v("#")]),t._v(" 6.2.异步查询工具axios")]),t._v(" "),s("p",[t._v("异步查询数据，自然是通过ajax查询，大家首先想起的肯定是jQuery。但jQuery与MVVM的思想不吻合，而且ajax只是jQuery的一小部分。因此不可能为了发起ajax请求而去引用这么大的一个库。")]),t._v(" "),s("h3",{attrs:{id:"_6-2-1-axios入门"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-1-axios入门"}},[t._v("#")]),t._v(" 6.2.1.axios入门")]),t._v(" "),s("p",[t._v("Vue官方推荐的ajax请求框架叫做：axios，看下demo：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526033988251.png",alt:"1526033988251"}})]),t._v(" "),s("p",[t._v("axios的Get请求语法：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/item/category/list?pid=0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求路径和请求参数拼接")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功回调函数")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 失败回调函数")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 参数较多时，可以通过params来传递参数")]),t._v("\naxios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/item/category/list"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("params")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功时的回调")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 失败时的回调")]),t._v("\n")])])]),s("p",[t._v("axios的POST请求语法：")]),t._v(" "),s("p",[t._v("比如新增一个用户")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/user"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Jack"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("注意，POST请求传参，不需要像GET请求那样定义一个对象，在对象的params参数中传参。post()方法的第二个参数对象，就是将来要传递的参数")]),t._v(" "),s("p",[t._v("PUT和DELETE请求与POST请求类似")]),t._v(" "),s("h3",{attrs:{id:"_6-2-2-axios的全局配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-2-axios的全局配置"}},[t._v("#")]),t._v(" 6.2.2.axios的全局配置")]),t._v(" "),s("p",[t._v("而在我们的项目中，已经引入了axios，并且进行了简单的封装，在src下的http.js中：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526034150067.png",alt:"1526034150067"}})]),t._v(" "),s("p",[t._v("http.js中对axios进行了一些默认配置：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" config "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./config'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// config中定义的基础路径是：http://api.leyou.com/api")]),t._v("\naxios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseURL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置axios的基础请求路径")]),t._v("\naxios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timeout "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置axios的请求时间")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$http "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将axios赋值给Vue原型的$http属性，这样所有vue实例都可使用该对象")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("http.js中导入了config的配置，还记得吗？")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526041205846.png",alt:"1526041205846"}})])]),t._v(" "),s("li",[s("p",[t._v("http.js对axios进行了全局配置："),s("code",[t._v("baseURL=config.api")]),t._v("，即"),s("code",[t._v("http://api.leyou.com/api")]),t._v("。因此以后所有用axios发起的请求，都会以这个地址作为前缀。")])]),t._v(" "),s("li",[s("p",[t._v("通过"),s("code",[t._v("Vue.property.$http = axios")]),t._v("，将"),s("code",[t._v("axios")]),t._v("赋值给了 Vue原型中的"),s("code",[t._v("$http")]),t._v("。这样以后所有的Vue实例都可以访问到$http，也就是访问到了axios了。")])])]),t._v(" "),s("h3",{attrs:{id:"_6-2-3-项目中使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-3-项目中使用"}},[t._v("#")]),t._v(" 6.2.3.项目中使用")]),t._v(" "),s("p",[t._v("我们在组件"),s("code",[t._v("Brand.vue")]),t._v("的getDataFromServer方法，通过$http发起get请求，测试查询品牌的接口，看是否能获取到数据：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1543067111272.png",alt:"1543067111272"}})]),t._v(" "),s("p",[t._v("网络监视：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526048143014.png",alt:"1526048143014"}})]),t._v(" "),s("p",[t._v("resp到底都有那些数据，查看控制台结果：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526048275064.png",alt:"1526048275064"}})]),t._v(" "),s("p",[t._v("可以看到，在请求成功的返回结果response中，有一个data属性，里面就是真正的响应数据。")]),t._v(" "),s("p",[t._v("响应结果中与我们设计的一致，包含3个内容：")]),t._v(" "),s("ul",[s("li",[t._v("total：总条数，目前是165")]),t._v(" "),s("li",[t._v("items：当前页数据")]),t._v(" "),s("li",[t._v("totalPage：总页数，我们没有返回")])]),t._v(" "),s("h2",{attrs:{id:"_6-3-完成分页和过滤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-完成分页和过滤"}},[t._v("#")]),t._v(" 6.3.完成分页和过滤")]),t._v(" "),s("h3",{attrs:{id:"_6-3-1-分页"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-1-分页"}},[t._v("#")]),t._v(" 6.3.1.分页")]),t._v(" "),s("p",[t._v("点击分页，会发起请求，通过浏览器工具查看，会发现pagination对象的属性一直在变化：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/9.gif",alt:""}})]),t._v(" "),s("p",[t._v("我们可以利用Vue的监视功能：watch，当pagination发生改变时，会调用我们的回调函数，我们在回调函数中进行数据的查询！")]),t._v(" "),s("p",[t._v("具体实现：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526049643506.png",alt:"1526049643506"}})]),t._v(" "),s("p",[t._v("成功实现分页功能：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/22.gif",alt:"1526049720200"}})]),t._v(" "),s("h3",{attrs:{id:"_6-3-2-过滤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-2-过滤"}},[t._v("#")]),t._v(" 6.3.2.过滤")]),t._v(" "),s("p",[t._v("过滤字段对应的是search属性，我们只要监视这个属性即可:")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526049939985.png",alt:"1526049939985"}})]),t._v(" "),s("p",[t._v("查看网络请求：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1526050032436.png",alt:"1526050032436"}})]),t._v(" "),s("p",[t._v("页面结果：")]),t._v(" "),s("p",[s("img",{attrs:{src:"assets/1530555740595.png",alt:"1530555740595"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);