(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{385:function(s,t,a){"use strict";a.r(t);var n=a(14),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_0-学习目标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-学习目标"}},[s._v("#")]),s._v(" 0.学习目标")]),s._v(" "),t("ul",[t("li",[s._v("了解商品规格数据结构设计思路")]),s._v(" "),t("li",[s._v("实现商品规格查询")]),s._v(" "),t("li",[s._v("了解SPU和SKU数据结构设计思路")]),s._v(" "),t("li",[s._v("实现商品查询")]),s._v(" "),t("li",[s._v("了解商品新增的页面实现")]),s._v(" "),t("li",[s._v("独立编写商品新增后台功能")])]),s._v(" "),t("h1",{attrs:{id:"_1-商品规格数据结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-商品规格数据结构"}},[s._v("#")]),s._v(" 1.商品规格数据结构")]),s._v(" "),t("p",[s._v("乐优商城是一个全品类的电商网站，因此商品的种类繁多，每一件商品，其属性又有差别。为了更准确描述商品及细分差别，抽象出两个概念：SPU和SKU，了解一下：")]),s._v(" "),t("h2",{attrs:{id:"_1-1-spu和sku"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-spu和sku"}},[s._v("#")]),s._v(" 1.1.SPU和SKU")]),s._v(" "),t("p",[s._v("SPU：Standard Product Unit （标准产品单位） ，一组具有共同属性的商品集")]),s._v(" "),t("p",[s._v("SKU：Stock Keeping Unit（库存量单位），SPU商品集因具体特性不同而细分的每个商品")]),s._v(" "),t("p",[s._v("以图为例来看：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526085541996.png",alt:"1526085541996"}})]),s._v(" "),t("ul",[t("li",[s._v("本页的 华为Mate10 就是一个商品集（SPU）")]),s._v(" "),t("li",[s._v("因为颜色、内存等不同，而细分出不同的Mate10，如亮黑色128G版。（SKU）")])]),s._v(" "),t("p",[s._v("可以看出：")]),s._v(" "),t("ul",[t("li",[s._v("SPU是一个抽象的商品集概念，为了方便后台的管理。")]),s._v(" "),t("li",[s._v("SKU才是具体要销售的商品，每一个SKU的价格、库存可能会不一样，用户购买的是SKU而不是SPU")])]),s._v(" "),t("h2",{attrs:{id:"_1-2-数据库设计分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-数据库设计分析"}},[s._v("#")]),s._v(" 1.2.数据库设计分析")]),s._v(" "),t("h3",{attrs:{id:"_1-2-1-思考并发现问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-思考并发现问题"}},[s._v("#")]),s._v(" 1.2.1.思考并发现问题")]),s._v(" "),t("p",[s._v("弄清楚了SPU和SKU的概念区分，接下来我们一起思考一下该如何设计数据库表。")]),s._v(" "),t("p",[s._v("首先来看SPU，大家一起思考下SPU应该有哪些字段来描述？")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("id:主键\ntitle：标题\ndescription：描述\nspecification：规格\npackaging_list：包装\nafter_service：售后服务\ncomment：评价\ncategory_id：商品分类\nbrand_id：品牌\n")])])]),t("p",[s._v("似乎并不复杂，但是大家仔细思考一下，商品的规格字段你如何填写？")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526086539789.png",alt:"1526086539789"}})]),s._v(" "),t("p",[s._v("不同商品的规格不一定相同，数据库中要如何保存？")]),s._v(" "),t("p",[s._v("再看下SKU，大家觉得应该有什么字段？")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("id：主键\nspu_id：关联的spu\nprice：价格\nimages：图片\nstock：库存\n颜色？\n内存？\n硬盘？\n")])])]),t("p",[s._v("碰到难题了，不同的商品分类，可能属性是不一样的，比如手机有内存，衣服有尺码，我们是全品类的电商网站，这些不同的商品的不同属性，如何设计到一张表中？")]),s._v(" "),t("p",[s._v("其实颜色、内存、硬盘属性都是规格参数中的字段。所以，要解决这个问题，首先要能清楚规格参数。")]),s._v(" "),t("h3",{attrs:{id:"_1-2-2-分析规格参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-分析规格参数"}},[s._v("#")]),s._v(" 1.2.2.分析规格参数")]),s._v(" "),t("p",[s._v("仔细查看每一种商品的规格你会发现：")]),s._v(" "),t("p",[s._v("虽然商品规格千变万化，但是同一类商品（如手机）的规格是统一的，有图为证：")]),s._v(" "),t("blockquote",[t("p",[s._v("华为的规格：")])]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526087063700.png",alt:"1526087063700"}})]),s._v(" "),t("blockquote",[t("p",[s._v("三星的规格：")])]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526087142454.png",alt:"1526087142454"}})]),s._v(" "),t("h3",{attrs:{id:"_1-2-3-sku的特有属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-sku的特有属性"}},[s._v("#")]),s._v(" 1.2.3.SKU的特有属性")]),s._v(" "),t("p",[s._v("SPU中会有一些特殊属性，用来区分不同的SKU，我们称为SKU特有属性。如华为META10的颜色、内存属性。")]),s._v(" "),t("p",[s._v("不同种类的商品，一个手机，一个衣服，其SKU属性不相同。")]),s._v(" "),t("p",[s._v("同一种类的商品，比如都是衣服，SKU属性基本是一样的，都是颜色、尺码等。")]),s._v(" "),t("p",[s._v("这样说起来，似乎SKU的特有属性也是与分类相关的？事实上，仔细观察你会发现，"),t("strong",[s._v("SKU的特有属性是商品规格参数的一部分")]),s._v("：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526088981953.png",alt:"1526088981953"}})]),s._v(" "),t("p",[s._v("也就是说，我们没必要单独对SKU的特有属性进行设计，它可以看做是规格参数中的一部分。这样规格参数中的属性可以标记成两部分：")]),s._v(" "),t("ul",[t("li",[s._v("spu下所有sku共享的规格属性（称为全局属性）")]),s._v(" "),t("li",[s._v("每个sku不同的规格属性（称为特有属性）")])]),s._v(" "),t("h3",{attrs:{id:"_1-2-4-搜索属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-4-搜索属性"}},[s._v("#")]),s._v(" 1.2.4.搜索属性")]),s._v(" "),t("p",[s._v("打开一个搜索页，我们来看看过滤的条件：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526090072535.png",alt:"1526090072535"}})]),s._v(" "),t("p",[s._v("你会发现，过滤条件中的屏幕尺寸、运行内存、网路、机身内存、电池容量、CPU核数等，在规格参数中都能找到：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526090228171.png",alt:"1526090228171"}})]),s._v(" "),t("p",[s._v("也就是说，规格参数中的数据，将来会有一部分作为搜索条件来使用。我们可以在设计时，将这部分属性标记出来，将来做搜索的时候，作为过滤条件。要注意的是，无论是SPU的全局属性，还是SKU的特有属性，都有可能作为搜索过滤条件的，并不冲突，而是有一个交集：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526091216124.png",alt:"1526091216124"}})]),s._v(" "),t("h2",{attrs:{id:"_1-3-规格参数表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-规格参数表"}},[s._v("#")]),s._v(" 1.3.规格参数表")]),s._v(" "),t("h3",{attrs:{id:"_1-3-1-表结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-表结构"}},[s._v("#")]),s._v(" 1.3.1.表结构")]),s._v(" "),t("p",[s._v("我们看下规格参数的格式：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526092179381.png",alt:"1526092179381"}})]),s._v(" "),t("p",[s._v("可以看到规格参数是分组的，每一组都有多个参数键值对。不过对于规格参数的模板而言，其值现在是不确定的，不同的商品值肯定不同，模板中只要保存组信息、组内参数信息即可。")]),s._v(" "),t("p",[s._v("因此我们设计了两张表：")]),s._v(" "),t("ul",[t("li",[s._v("tb_spec_group：组，与商品分类关联")]),s._v(" "),t("li",[s._v("tb_spec_param：参数名，与组关联，一对多")])]),s._v(" "),t("h3",{attrs:{id:"_1-3-2-规格组"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-规格组"}},[s._v("#")]),s._v(" 1.3.2.规格组")]),s._v(" "),t("p",[s._v("规格参数分组表：tb_spec_group")]),s._v(" "),t("div",{staticClass:"language-mysql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CREATE TABLE `tb_spec_group` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '主键',\n  `cid` bigint(20) NOT NULL COMMENT '商品分类id，一个分类下有多个规格组',\n  `name` varchar(50) NOT NULL COMMENT '规格组的名称',\n  PRIMARY KEY (`id`),\n  KEY `key_category` (`cid`)\n) ENGINE=InnoDB AUTO_INCREMENT=14 DEFAULT CHARSET=utf8 COMMENT='规格参数的分组表，每个商品分类下有多个规格参数组';\n")])])]),t("p",[s._v("规格组有3个字段：")]),s._v(" "),t("ul",[t("li",[s._v("id：主键")]),s._v(" "),t("li",[s._v("cid：商品分类id，一个分类下有多个模板")]),s._v(" "),t("li",[s._v("name：该规格组的名称。")])]),s._v(" "),t("h3",{attrs:{id:"_1-3-2-规格参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-规格参数"}},[s._v("#")]),s._v(" 1.3.2.规格参数")]),s._v(" "),t("p",[s._v("规格参数表：tb_spec_param")]),s._v(" "),t("div",{staticClass:"language-mysql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CREATE TABLE `tb_spec_param` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '主键',\n  `cid` bigint(20) NOT NULL COMMENT '商品分类id',\n  `group_id` bigint(20) NOT NULL,\n  `name` varchar(255) NOT NULL COMMENT '参数名',\n  `numeric` tinyint(1) NOT NULL COMMENT '是否是数字类型参数，true或false',\n  `unit` varchar(255) DEFAULT '' COMMENT '数字类型参数的单位，非数字类型可以为空',\n  `generic` tinyint(1) NOT NULL COMMENT '是否是sku通用属性，true或false',\n  `searching` tinyint(1) NOT NULL COMMENT '是否用于搜索过滤，true或false',\n  `segments` varchar(1000) DEFAULT '' COMMENT '数值类型参数，如果需要搜索，则添加分段间隔值，如CPU频率间隔：0.5-1.0',\n  PRIMARY KEY (`id`),\n  KEY `key_group` (`group_id`),\n  KEY `key_category` (`cid`)\n) ENGINE=InnoDB AUTO_INCREMENT=24 DEFAULT CHARSET=utf8 COMMENT='规格参数组下的参数名';\n")])])]),t("p",[s._v("按道理来说，我们的规格参数就只需要记录参数名、组id、商品分类id即可。但是这里却多出了很多字段，为什么？")]),s._v(" "),t("p",[s._v("还记得我们之前的分析吧，规格参数中有一部分是 SKU的通用属性，一部分是SKU的特有属性，而且其中会有一些将来用作搜索过滤，这些信息都需要标记出来。")]),s._v(" "),t("blockquote",[t("p",[s._v("通用属性")])]),s._v(" "),t("p",[s._v("用一个布尔类型字段来标记是否为通用：")]),s._v(" "),t("ul",[t("li",[s._v("generic来标记是否为通用属性：\n"),t("ul",[t("li",[s._v("true：代表通用属性")]),s._v(" "),t("li",[s._v("false：代表sku特有属性")])])])]),s._v(" "),t("blockquote",[t("p",[s._v("搜索过滤")])]),s._v(" "),t("p",[s._v("与搜索相关的有两个字段：")]),s._v(" "),t("ul",[t("li",[s._v("searching：标记是否用作过滤\n"),t("ul",[t("li",[s._v("true：用于过滤搜索")]),s._v(" "),t("li",[s._v("false：不用于过滤")])])]),s._v(" "),t("li",[s._v("segments：某些数值类型的参数，在搜索时需要按区间划分，这里提前确定好划分区间\n"),t("ul",[t("li",[s._v("比如电池容量，0~2000mAh，2000mAh~3000mAh，3000mAh~4000mAh")])])])]),s._v(" "),t("blockquote",[t("p",[s._v("数值类型")])]),s._v(" "),t("p",[s._v("某些规格参数可能为数值类型，这样的数据才需要划分区间，我们有两个字段来描述：")]),s._v(" "),t("ul",[t("li",[s._v("numberic：是否为数值类型\n"),t("ul",[t("li",[s._v("true：数值类型")]),s._v(" "),t("li",[s._v("false：不是数值类型")])])]),s._v(" "),t("li",[s._v("unit：参数的单位")])]),s._v(" "),t("h1",{attrs:{id:"_2-商品规格参数管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-商品规格参数管理"}},[s._v("#")]),s._v(" 2.商品规格参数管理")]),s._v(" "),t("h2",{attrs:{id:"_2-1-页面布局"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-页面布局"}},[s._v("#")]),s._v(" 2.1.页面布局")]),s._v(" "),t("h3",{attrs:{id:"_2-1-1-整体布局"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-整体布局"}},[s._v("#")]),s._v(" 2.1.1.整体布局")]),s._v(" "),t("p",[s._v("打开规格参数页面，看到如下内容：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1529549099049.png",alt:"1529549099049"}})]),s._v(" "),t("p",[s._v("商品分类树我们之前已经做过，所以这里可以直接展示出来。")]),s._v(" "),t("p",[s._v("因为规格是跟商品分类绑定的，因此首先会展现商品分类树，并且提示你要选择商品分类，才能看到规格参数的模板。一起了解下页面的实现：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1529549521623.png",alt:"1529549521623"}})]),s._v(" "),t("p",[s._v("页面结构：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528423299102.png",alt:"1528423299102"}})]),s._v(" "),t("p",[s._v("这里使用了"),t("code",[s._v("v-layout")]),s._v("来完成页面布局，并且添加了row属性，代表接下来的内容是行布局（左右）。")]),s._v(" "),t("p",[s._v("可以看出页面分成2个部分：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("<v-flex xs3>")]),s._v("：左侧，内部又分上下两部分：商品分类树及标题\n"),t("ul",[t("li",[t("code",[s._v("v-card-title")]),s._v("：标题部分，这里是提示信息，告诉用户要先选择分类，才能看到模板")]),s._v(" "),t("li",[t("code",[s._v("v-tree")]),s._v("：这里用到的是我们之前讲过的树组件，展示商品分类树，")])])]),s._v(" "),t("li",[t("code",[s._v('<v-flex xs9 class="px-1">')]),s._v("：右侧：内部是规格参数展示")])]),s._v(" "),t("h3",{attrs:{id:"_2-1-2-右侧规格"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-右侧规格"}},[s._v("#")]),s._v(" 2.1.2.右侧规格")]),s._v(" "),t("p",[s._v("当我们点击一个分类时，最终要达到的效果：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1529550402376.png",alt:"1529550402376"}})]),s._v(" "),t("p",[s._v("可以看到右侧分为上下两部分：")]),s._v(" "),t("ul",[t("li",[s._v("上部：面包屑，显示当前选中的分类")]),s._v(" "),t("li",[s._v("下部：table，显示规格参数信息")])]),s._v(" "),t("p",[s._v("页面实现：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1529550694218.png",alt:"1529550694218"}})]),s._v(" "),t("p",[s._v("可以看到右侧并不是我们熟悉的 "),t("code",[s._v("v-data-table")]),s._v("，而是一个"),t("code",[s._v("spec-group")]),s._v("组件（规格组）和"),t("code",[s._v("spec-param")]),s._v("组件（规格参数），这是我们定义的独立组件：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1529550775415.png",alt:"1529550775415"}})]),s._v(" "),t("p",[s._v("在SpecGroup中定义了表格：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528427514717.png",alt:"1528427514717"}})]),s._v(" "),t("h2",{attrs:{id:"_2-2-规格组的查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-规格组的查询"}},[s._v("#")]),s._v(" 2.2.规格组的查询")]),s._v(" "),t("h3",{attrs:{id:"_2-2-1-树节点的点击事件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-树节点的点击事件"}},[s._v("#")]),s._v(" 2.2.1.树节点的点击事件")]),s._v(" "),t("p",[s._v("当我们点击树节点时，要将"),t("code",[s._v("v-dialog")]),s._v("打开，因此必须绑定一个点击事件：（Specification.vue）")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528428028513.png",alt:"1528428028513"}})]),s._v(" "),t("p",[s._v("我们来看下"),t("code",[s._v("handleClick")]),s._v("方法：（Specification.vue）")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528428221957.png",alt:"1528428221957"}})]),s._v(" "),t("p",[s._v("点击事件发生时，发生了两件事：")]),s._v(" "),t("ul",[t("li",[s._v("记录当前选中的节点，选中的就是商品分类")]),s._v(" "),t("li",[t("code",[s._v("showGroup")]),s._v("被置为true，则规格组就会显示了。")])]),s._v(" "),t("p",[s._v("同时，我们把被选中的节点（商品分类）的id传递给了"),t("code",[s._v("SpecGroup")]),s._v("组件：（Specification.vue）")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528428308113.png",alt:"1528428308113"}})]),s._v(" "),t("h3",{attrs:{id:"_2-2-2-页面查询规格组"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-页面查询规格组"}},[s._v("#")]),s._v(" 2.2.2.页面查询规格组")]),s._v(" "),t("p",[s._v("来看下"),t("code",[s._v("SpecGroup.vue")]),s._v("中的实现：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528428617046.png",alt:"1528428617046"}})]),s._v(" "),t("p",[s._v("我们查看页面控制台，可以看到请求已经发出：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528428699027.png",alt:"1528428699027"}})]),s._v(" "),t("h3",{attrs:{id:"_2-2-3-后端代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-后端代码"}},[s._v("#")]),s._v(" 2.2.3.后端代码")]),s._v(" "),t("blockquote",[t("p",[s._v("实体类")])]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("leyou-item-interface")]),s._v("中添加实体类：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528429029149.png",alt:"1528429029149"}})]),s._v(" "),t("p",[s._v("内容：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Table")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tb_spec_group"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecGroup")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Id")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GeneratedValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strategy "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GenerationType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IDENTITY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" cid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transient")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" params"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// getter和setter省略")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Table")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tb_spec_param"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParam")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Id")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GeneratedValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strategy "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GenerationType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IDENTITY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" cid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" groupId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Column")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"`numeric`"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),s._v(" numeric"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" unit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),s._v(" generic"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),s._v(" searching"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" segments"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// getter和setter ...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("在"),t("code",[s._v("leyou-item-service")]),s._v("中编写业务：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528433648595.png",alt:"1528433648595"}})]),s._v(" "),t("blockquote",[t("p",[s._v("mapper")])]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecGroupMapper")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mapper")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecGroup")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("controller")])]),s._v(" "),t("p",[s._v("先分析下需要的东西，在页面的ajax请求中可以看出：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("请求方式：get")])]),s._v(" "),t("li",[t("p",[s._v("请求路径：/spec/groups/{cid} ，这里通过路径占位符传递商品分类的id")])]),s._v(" "),t("li",[t("p",[s._v("请求参数：商品分类id")])]),s._v(" "),t("li",[t("p",[s._v("返回结果：页面是直接把"),t("code",[s._v("resp.data")]),s._v("赋值给了groups：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528429342796.png",alt:"1528429342796"}})]),s._v(" "),t("p",[s._v("那么我们返回的应该是规格组SpecGroup的集合")])])]),s._v(" "),t("p",[s._v("代码：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"spec"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecificationController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecificationService")]),s._v(" specificationService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 根据分类id查询分组\n     * @param cid\n     * @return\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"groups/{cid}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseEntity")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecGroup")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryGroupsByCid")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@PathVariable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cid"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" cid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecGroup")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" groups "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("specificationService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryGroupsByCid")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CollectionUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("groups"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseEntity")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("notFound")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseEntity")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ok")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("groups"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("service")])]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecificationService")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecGroupMapper")]),s._v(" groupMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 根据分类id查询分组\n     * @param cid\n     * @return\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecGroup")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryGroupsByCid")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" cid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecGroup")]),s._v(" specGroup "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecGroup")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        specGroup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setCid")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("groupMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("select")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("specGroup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),t("blockquote",[t("p",[s._v("页面访问测试：")])]),s._v(" "),t("p",[s._v("目前，我们数据库只为手机分类（76）提供了规格组：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528433697492.png",alt:"1528433697492"}})]),s._v(" "),t("p",[s._v("我们访问：http://api.leyou.com/api/item/spec/groups/76")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528433733340.png",alt:"1528433733340"}})]),s._v(" "),t("p",[s._v("然后在后台系统中测试：\n"),t("img",{attrs:{src:"assets/1528433821121.png",alt:"1528433821121"}})]),s._v(" "),t("h2",{attrs:{id:"_2-3-规格参数查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-规格参数查询"}},[s._v("#")]),s._v(" 2.3.规格参数查询")]),s._v(" "),t("h3",{attrs:{id:"_2-3-1-表格切换"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-表格切换"}},[s._v("#")]),s._v(" 2.3.1.表格切换")]),s._v(" "),t("p",[s._v("当我们点击规格组，会切换到规格参数显示，肯定是在规格组中绑定了点击事件：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528429949504.png",alt:"1528429949504"}})]),s._v(" "),t("p",[s._v("我们看下事件处理：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528429988410.png",alt:"1528429988410"}})]),s._v(" "),t("p",[s._v("可以看到这里是使用了父子通信，子组件触发了select事件：")]),s._v(" "),t("p",[s._v("再来看下父组件的事件绑定：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528430052736.png",alt:"1528430052736"}})]),s._v(" "),t("p",[s._v("事件处理：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528430100166.png",alt:"1528430100166"}})]),s._v(" "),t("p",[s._v("这里我们记录了选中的分组，并且把标记设置为false，这样规格组就不显示了，而是显示："),t("code",[s._v("SpecParam")])]),s._v(" "),t("p",[s._v("并且，我们把group也传递到"),t("code",[s._v("spec-param")]),s._v("组件：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528430147829.png",alt:"1528430147829"}})]),s._v(" "),t("h3",{attrs:{id:"_2-3-2-页面查询规格参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-2-页面查询规格参数"}},[s._v("#")]),s._v(" 2.3.2.页面查询规格参数")]),s._v(" "),t("p",[s._v("我们来看"),t("code",[s._v("SpecParam.vue")]),s._v("的实现：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528430319461.png",alt:"1528430319461"}})]),s._v(" "),t("p",[s._v("查看页面控制台，发现请求已经发出：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528430407298.png",alt:"1528430407298"}})]),s._v(" "),t("p",[s._v("报404，因为我们还没有实现后台逻辑，接下来就去实现。")]),s._v(" "),t("h3",{attrs:{id:"_2-3-3-后台实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-3-后台实现"}},[s._v("#")]),s._v(" 2.3.3.后台实现")]),s._v(" "),t("blockquote",[t("p",[s._v("SpecificationController")])]),s._v(" "),t("p",[s._v("分析：")]),s._v(" "),t("ul",[t("li",[s._v("请求方式：GET")]),s._v(" "),t("li",[s._v("请求路径：/spec/params")]),s._v(" "),t("li",[s._v("请求参数：gid，分组id")]),s._v(" "),t("li",[s._v("返回结果：该分组下的规格参数集合"),t("code",[s._v("List<SpecParam>")])])]),s._v(" "),t("p",[s._v("代码：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 根据条件查询规格参数\n     * @param gid\n     * @return\n     */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"params"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseEntity")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryParams")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gid"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" gid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("  params "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("specificationService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryParams")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CollectionUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("params"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseEntity")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("notFound")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseEntity")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ok")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("params"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("SpecificationService")])]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParamMapper")]),s._v(" paramMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 根据条件查询规格参数\n     * @param gid\n     * @return\n     */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryParams")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" gid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParam")]),s._v(" param "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    param"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setGroupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("paramMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("select")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("param"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("SpecParamMapper")])]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1543383516456.png",alt:"1543383516456"}})]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParamMapper")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mapper")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpecParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528442972016.png",alt:"1528442972016"}})]),s._v(" "),t("h2",{attrs:{id:"_2-4-增、删、改-作业"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-增、删、改-作业"}},[s._v("#")]),s._v(" 2.4.增、删、改（作业）")]),s._v(" "),t("p",[s._v("增删改的作业就留给大家去完成了。页面中接口都已定义，你要做的就是实现后台接口。")]),s._v(" "),t("h1",{attrs:{id:"_3-spu和sku数据结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-spu和sku数据结构"}},[s._v("#")]),s._v(" 3.SPU和SKU数据结构")]),s._v(" "),t("p",[s._v("规格确定以后，就可以添加商品了,先看下数据库表")]),s._v(" "),t("h2",{attrs:{id:"_3-1-spu表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-spu表"}},[s._v("#")]),s._v(" 3.1.SPU表")]),s._v(" "),t("p",[s._v("SPU表：")]),s._v(" "),t("div",{staticClass:"language-mysql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CREATE TABLE `tb_spu` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'spu id',\n  `title` varchar(255) NOT NULL DEFAULT '' COMMENT '标题',\n  `sub_title` varchar(255) DEFAULT '' COMMENT '子标题',\n  `cid1` bigint(20) NOT NULL COMMENT '1级类目id',\n  `cid2` bigint(20) NOT NULL COMMENT '2级类目id',\n  `cid3` bigint(20) NOT NULL COMMENT '3级类目id',\n  `brand_id` bigint(20) NOT NULL COMMENT '商品所属品牌id',\n  `saleable` tinyint(1) NOT NULL DEFAULT '1' COMMENT '是否上架，0下架，1上架',\n  `valid` tinyint(1) NOT NULL DEFAULT '1' COMMENT '是否有效，0已删除，1有效',\n  `create_time` datetime DEFAULT NULL COMMENT '添加时间',\n  `last_update_time` datetime DEFAULT NULL COMMENT '最后修改时间',\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=208 DEFAULT CHARSET=utf8 COMMENT='spu表，该表描述的是一个抽象的商品，比如 iphone8';\n")])])]),t("p",[s._v("与我们前面分析的基本类似，但是似乎少了一些字段，比如商品描述。")]),s._v(" "),t("p",[s._v("我们做了表的垂直拆分，将SPU的详情放到了另一张表：tb_spu_detail")]),s._v(" "),t("div",{staticClass:"language-mysql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CREATE TABLE `tb_spu_detail` (\n  `spu_id` bigint(20) NOT NULL,\n  `description` text COMMENT '商品描述信息',\n  `generic_spec` varchar(10000) NOT NULL DEFAULT '' COMMENT '通用规格参数数据',\n  `special_spec` varchar(1000) NOT NULL COMMENT '特有规格参数及可选值信息，json格式',\n  `packing_list` varchar(3000) DEFAULT '' COMMENT '包装清单',\n  `after_service` varchar(3000) DEFAULT '' COMMENT '售后服务',\n  PRIMARY KEY (`spu_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n")])])]),t("p",[s._v("这张表中的数据都比较大，为了不影响主表的查询效率我们拆分出这张表。")]),s._v(" "),t("p",[s._v("需要注意的是这两个字段：generic_spec和special_spec。")]),s._v(" "),t("p",[s._v("前面讲过规格参数与商品分类绑定，一个分类下的所有SPU具有类似的规格参数。SPU下的SKU可能会有不同的规格参数信息，因此我们计划是这样：")]),s._v(" "),t("ul",[t("li",[s._v("SPUDetail中保存通用的规格参数信息。")]),s._v(" "),t("li",[s._v("SKU中保存特有规格参数。")])]),s._v(" "),t("p",[s._v("来看下我们的表如何存储这些信息。")]),s._v(" "),t("h3",{attrs:{id:"_3-1-1-generic-spec字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-generic-spec字段"}},[s._v("#")]),s._v(" 3.1.1.generic_spec字段")]),s._v(" "),t("p",[s._v("首先是"),t("code",[s._v("generic_spec")]),s._v("，其中保存通用规格参数信息的值，这里为了方便查询，使用了json格式：")]),s._v(" "),t("blockquote",[t("p",[s._v("整体来看：")])]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1529554390912.png",alt:"1529554390912"}})]),s._v(" "),t("p",[s._v("json结构，其中都是键值对：")]),s._v(" "),t("ul",[t("li",[s._v("key：对应的规格参数的"),t("code",[s._v("spec_param")]),s._v("的id")]),s._v(" "),t("li",[s._v("value：对应规格参数的值")])]),s._v(" "),t("h3",{attrs:{id:"_3-1-2-special-spec字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-2-special-spec字段"}},[s._v("#")]),s._v(" 3.1.2.special_spec字段")]),s._v(" "),t("p",[s._v("我们说spu中只保存通用规格参数，那么为什么有多出了一个"),t("code",[s._v("special_spec")]),s._v("字段呢？")]),s._v(" "),t("p",[s._v("以手机为例，品牌、操作系统等肯定是全局通用属性，内存、颜色等肯定是特有属性。")]),s._v(" "),t("p",[s._v("当你确定了一个SPU，比如小米的：红米4X")]),s._v(" "),t("p",[s._v("全局属性值都是固定的了：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("品牌：小米\n型号：红米4X\n")])])]),t("p",[s._v("特有属性举例：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("颜色：[香槟金, 樱花粉, 磨砂黑]\n内存：[2G, 3G]\n机身存储：[16GB, 32GB]\n")])])]),t("p",[s._v("颜色、内存、机身存储，作为SKU特有属性，key虽然一样，但是SPU下的每一个SKU，其值都不一样，所以值会有很多，形成数组。")]),s._v(" "),t("p",[s._v("我们在SPU中，会把特有属性的所有值都记录下来，形成一个数组：")]),s._v(" "),t("p",[s._v("里面又有哪些内容呢？")]),s._v(" "),t("p",[s._v("来看数据格式：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1529554916252.png",alt:"1529554916252"}})]),s._v(" "),t("p",[s._v("也是json结构：")]),s._v(" "),t("ul",[t("li",[s._v("key：规格参数id")]),s._v(" "),t("li",[s._v("value：spu属性的数组")])]),s._v(" "),t("p",[s._v("那么问题来：特有规格参数应该在sku中记录才对，为什么在spu中也要记录一份？")]),s._v(" "),t("p",[s._v("因为我们有时候需要把所有规格参数都查询出来，而不是只查询1个sku的属性。比如，商品详情页展示可选的规格参数时：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526267828817.png",alt:"1526267828817"}})]),s._v(" "),t("p",[s._v("刚好符合我们的结构，这样页面渲染就非常方便了。")]),s._v(" "),t("h2",{attrs:{id:"_3-2-sku表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-sku表"}},[s._v("#")]),s._v(" 3.2.SKU表")]),s._v(" "),t("div",{staticClass:"language-mysql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CREATE TABLE `tb_sku` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'sku id',\n  `spu_id` bigint(20) NOT NULL COMMENT 'spu id',\n  `title` varchar(255) NOT NULL COMMENT '商品标题',\n  `images` varchar(1000) DEFAULT '' COMMENT '商品的图片，多个图片以‘,’分割',\n  `price` bigint(15) NOT NULL DEFAULT '0' COMMENT '销售价格，单位为分',\n  `indexes` varchar(100) COMMENT '特有规格属性在spu属性模板中的对应下标组合',\n  `own_spec` varchar(1000) COMMENT 'sku的特有规格参数，json格式',\n  `enable` tinyint(1) NOT NULL DEFAULT '1' COMMENT '是否有效，0无效，1有效',\n  `create_time` datetime NOT NULL COMMENT '添加时间',\n  `last_update_time` datetime NOT NULL COMMENT '最后修改时间',\n  PRIMARY KEY (`id`),\n  KEY `key_spu_id` (`spu_id`) USING BTREE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='sku表,该表表示具体的商品实体,如黑色的64GB的iphone 8';\n")])])]),t("p",[s._v("还有一张表，代表库存：")]),s._v(" "),t("div",{staticClass:"language-mysql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CREATE TABLE `tb_stock` (\n  `sku_id` bigint(20) NOT NULL COMMENT '库存对应的商品sku id',\n  `seckill_stock` int(9) DEFAULT '0' COMMENT '可秒杀库存',\n  `seckill_total` int(9) DEFAULT '0' COMMENT '秒杀总数量',\n  `stock` int(9) NOT NULL COMMENT '库存数量',\n  PRIMARY KEY (`sku_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='库存表，代表库存，秒杀库存等信息';\n")])])]),t("p",[s._v("问题：为什么要将库存独立一张表？")]),s._v(" "),t("p",[s._v("因为库存字段写频率较高，而SKU的其它字段以读为主，因此我们将两张表分离，读写不会干扰。")]),s._v(" "),t("p",[s._v("特别需要注意的是sku表中的"),t("code",[s._v("indexes")]),s._v("字段和"),t("code",[s._v("own_spec")]),s._v("字段。sku中应该保存特有规格参数的值，就在这两个字段中。")]),s._v(" "),t("h3",{attrs:{id:"_3-2-1-indexes字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-indexes字段"}},[s._v("#")]),s._v(" 3.2.1.indexes字段")]),s._v(" "),t("p",[s._v("在SPU表中，已经对特有规格参数及可选项进行了保存，结构如下：")]),s._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"4"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"香槟金"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"樱花粉"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"磨砂黑"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"12"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2GB"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3GB"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"13"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"16GB"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"32GB"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("这些特有属性如果排列组合，会产生12个不同的SKU，而不同的SKU，其属性就是上面备选项中的一个。")]),s._v(" "),t("p",[s._v("比如：")]),s._v(" "),t("ul",[t("li",[s._v("红米4X，香槟金，2GB内存，16GB存储")]),s._v(" "),t("li",[s._v("红米4X，磨砂黑，2GB内存，32GB存储")])]),s._v(" "),t("p",[s._v("你会发现，每一个属性值，对应于SPUoptions数组的一个选项，如果我们记录下角标，就是这样：")]),s._v(" "),t("ul",[t("li",[s._v("红米4X，0,0,0")]),s._v(" "),t("li",[s._v("红米4X，2,0,1")])]),s._v(" "),t("p",[s._v("既然如此，我们是不是可以将不同角标串联起来，作为SPU下不同SKU的标示。这就是我们的indexes字段。")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526266901335.png",alt:"1526266901335"}})]),s._v(" "),t("p",[s._v("这个设计在商品详情页会特别有用：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526267180997.png",alt:"1526267180997"}})]),s._v(" "),t("p",[s._v("当用户点击选中一个特有属性，你就能根据 角标快速定位到sku。")]),s._v(" "),t("h3",{attrs:{id:"_3-2-2-own-spec字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-own-spec字段"}},[s._v("#")]),s._v(" 3.2.2.own_spec字段")]),s._v(" "),t("p",[s._v("看结构：")]),s._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"4"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"香槟金"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"12"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2GB"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"13"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"16GB"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("保存的是特有属性的键值对。")]),s._v(" "),t("p",[s._v("SPU中保存的是可选项，但不确定具体的值，而SKU中的保存的就是具体的值。")]),s._v(" "),t("h2",{attrs:{id:"_3-3-导入图片信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-导入图片信息"}},[s._v("#")]),s._v(" 3.3.导入图片信息")]),s._v(" "),t("p",[s._v("现在商品表中虽然有数据，但是所有的图片信息都是无法访问的，我们需要把图片导入到虚拟机：")]),s._v(" "),t("p",[s._v("首先，把课前资料提供的数据上传到虚拟机下："),t("code",[s._v("/leyou/static")]),s._v("目录：在leyou下创建static目录")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528445149890.png",alt:"1528445149890"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528479229165.png",alt:"1528479229165"}})]),s._v(" "),t("p",[s._v("然后，使用命令解压缩：")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" images.zip\n")])])]),t("p",[s._v("修改Nginx配置，使nginx反向代理这些图片地址：")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /opt/nginx/config/nginx.conf\n")])])]),t("p",[s._v("修改成如下配置：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v("  image.leyou.com")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监听域名中带有group的，交给FastDFS模块处理")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" ~/group([0-9])/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ngx_fastdfs_module")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将其它图片代理指向本地的/leyou/static目录")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v("   /leyou/static/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_page")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("503")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v("  /50x.html")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" = /50x.html")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v("   html")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("不要忘记重新加载nginx配置")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("nginx -s reload\n")])])]),t("h1",{attrs:{id:"_4-商品查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-商品查询"}},[s._v("#")]),s._v(" 4.商品查询")]),s._v(" "),t("h2",{attrs:{id:"_4-1-效果预览"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-效果预览"}},[s._v("#")]),s._v(" 4.1.效果预览")]),s._v(" "),t("p",[s._v("接下来，我们实现商品管理的页面，先看下我们要实现的效果：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1526268595873.png",alt:"1526268595873"}})]),s._v(" "),t("p",[s._v("可以看出整体是一个table，然后有新增按钮。是不是跟昨天写品牌管理很像？")]),s._v(" "),t("h2",{attrs:{id:"_4-2-页面请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-页面请求"}},[s._v("#")]),s._v(" 4.2.页面请求")]),s._v(" "),t("p",[s._v("先看整体页面结构（Goods.vue）：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528447301687.png",alt:"1528447301687"}})]),s._v(" "),t("p",[s._v("并且在Vue实例挂载后就会发起查询(mounted调用getDataFromServer方法初始化数据)：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528447431959.png",alt:"1528447431959"}})]),s._v(" "),t("p",[s._v("我们刷新页面，可以看到浏览器发起已经发起了查询商品数据的请求：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528447591939.png",alt:"1528447591939"}})]),s._v(" "),t("p",[s._v("因此接下来，我们编写接口即可。")]),s._v(" "),t("h2",{attrs:{id:"_4-3-后台提供接口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-后台提供接口"}},[s._v("#")]),s._v(" 4.3.后台提供接口")]),s._v(" "),t("p",[s._v("页面已经准备好，接下来在后台提供分页查询SPU的功能。")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1543414148030.png",alt:"1543414148030"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1543413983147.png",alt:"1543413983147"}})]),s._v(" "),t("h3",{attrs:{id:"_4-3-1-实体类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-实体类"}},[s._v("#")]),s._v(" 4.3.1.实体类")]),s._v(" "),t("p",[s._v("在leyou-item-interface工程中添加实体类：")]),s._v(" "),t("blockquote",[t("p",[s._v("SPU")])]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Table")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tb_spu"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Spu")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Id")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GeneratedValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strategy "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GenerationType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IDENTITY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" brandId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" cid1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1级类目")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" cid2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2级类目")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" cid3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3级类目")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" title"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 标题")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" subTitle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 子标题")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),s._v(" saleable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 是否上架")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),s._v(" valid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 是否有效，逻辑删除用")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")]),s._v(" createTime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 创建时间")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")]),s._v(" lastUpdateTime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 最后修改时间")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 省略getter和setter")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("SPU详情")])]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Table")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tb_spu_detail"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuDetail")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Id")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" spuId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 对应的SPU的id")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" description"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 商品描述")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" specialSpec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 商品特殊规格的名称及可选值模板")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" genericSpec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 商品的全局规格属性")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" packingList"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 包装清单")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" afterService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 售后服务")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 省略getter和setter")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"_4-4-2-mapper"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-2-mapper"}},[s._v("#")]),s._v(" 4.4.2.mapper")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuMapper")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mapper")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Spu")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"_4-3-3-controller"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-3-controller"}},[s._v("#")]),s._v(" 4.3.3.controller")]),s._v(" "),t("p",[s._v("先分析：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("请求方式：GET")])]),s._v(" "),t("li",[t("p",[s._v("请求路径：/spu/page")])]),s._v(" "),t("li",[t("p",[s._v("请求参数：")]),s._v(" "),t("ul",[t("li",[s._v("page：当前页")]),s._v(" "),t("li",[s._v("rows：每页大小")]),s._v(" "),t("li",[s._v("key：过滤条件")]),s._v(" "),t("li",[s._v("saleable：上架或下架")])])]),s._v(" "),t("li",[t("p",[s._v("返回结果：商品SPU的分页信息。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("要注意，页面展示的是商品分类和品牌名称，而数据库中保存的是id，怎么办？")]),s._v(" "),t("p",[s._v("我们可以新建一个类，继承SPU，并且拓展cname和bname属性，写到"),t("code",[s._v("leyou-item-interface")])]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuBo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Spu")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" cname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 商品分类名称")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" bname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 品牌名称")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 略 。。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])])])])]),s._v(" "),t("p",[s._v("编写controller代码：")]),s._v(" "),t("p",[s._v("我们把与商品相关的一切业务接口都放到一起，起名为GoodsController，业务层也是这样")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Controller")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GoodsController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GoodsService")]),s._v(" goodsService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"spu/page"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseEntity")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PageResult")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuBo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("querySpuBoByPage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" required "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"saleable"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" required "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),s._v(" saleable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"page"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" defaultValue "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" page"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rows"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" defaultValue "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" rows\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PageResult")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuBo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" pageResult "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("goodsService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("querySpuBoByPage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" saleable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" page"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rows"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CollectionUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pageResult"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getItems")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseEntity")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("notFound")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseEntity")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ok")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pageResult"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"_4-4-4-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-4-service"}},[s._v("#")]),s._v(" 4.4.4.service")]),s._v(" "),t("p",[s._v("所有商品相关的业务（包括SPU和SKU）放到一个业务下：GoodsService。")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GoodsService")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuMapper")]),s._v(" spuMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CategoryService")]),s._v(" categoryService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BrandMapper")]),s._v(" brandMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PageResult")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuBo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("querySpuBoByPage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),s._v(" saleable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" page"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" rows"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v(" example "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Spu")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Criteria")]),s._v(" criteria "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" example"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createCriteria")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 搜索条件")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isNotBlank")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            criteria"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("andLike")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"title"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" key "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("saleable "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            criteria"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("andEqualTo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"saleable"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" saleable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 分页条件")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PageHelper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("startPage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("page"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rows"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 执行查询")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Spu")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" spus "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("spuMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectByExample")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("example"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PageInfo")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Spu")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" pageInfo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PageInfo")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("spus"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuBo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" spuBos "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        spus"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("spu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuBo")]),s._v(" spuBo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpuBo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// copy共同属性的值到新的对象")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BeanUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("copyProperties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("spu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" spuBo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 查询分类名称")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" names "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("categoryService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryNamesByIds")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("asList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("spu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCid1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" spu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCid2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" spu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCid3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            spuBo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setCname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("names"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 查询品牌的名称")]),s._v("\n            spuBo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setBname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("brandMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectByPrimaryKey")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("spu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBrandId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            spuBos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("spuBo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PageResult")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pageInfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getTotal")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" spuBos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"_4-4-5-category中拓展查询名称的功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-5-category中拓展查询名称的功能"}},[s._v("#")]),s._v(" 4.4.5.Category中拓展查询名称的功能")]),s._v(" "),t("p",[s._v("页面需要商品的分类名称需要在这里查询，因此要额外提供查询分类名称的功能，")]),s._v(" "),t("p",[s._v("在CategoryService中添加功能：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryNamesByIds")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" ids"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Category")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" list "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("categoryMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectByIdList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ids"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" names "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Category")]),s._v(" category "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        names"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("category"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" names"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// return list.stream().map(category -> category.getName()).collect(Collectors.toList());")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("mapper的selectByIdList方法是来自于通用mapper。不过需要我们在mapper上继承一个通用mapper接口：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CategoryMapper")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mapper")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Category")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SelectByIdListMapper")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Category")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h2",{attrs:{id:"_4-5-测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-测试"}},[s._v("#")]),s._v(" 4.5.测试")]),s._v(" "),t("p",[s._v("刷新页面，查看效果：")]),s._v(" "),t("p",[t("img",{attrs:{src:"assets/1528450054541.png",alt:"1528450054541"}})]),s._v(" "),t("p",[s._v("基本与预览的效果一致，OK！")])])}),[],!1,null,null,null);t.default=e.exports}}]);